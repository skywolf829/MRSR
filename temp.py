from numpy.lib.npyio import load
import torch
import torch.nn.functional as F
from utility_functions import AvgPool3D
import h5py
import imageio
import numpy as np
import matplotlib.pyplot as plt
from utility_functions import AvgPool2D
import os
import h5py
from netCDF4 import Dataset

FlowSTSR_folder_path = os.path.dirname(os.path.abspath(__file__))


load_folder = os.path.join(FlowSTSR_folder_path, "TrainingData", "Supernova", "0.h5")
f = h5py.File(load_folder, 'r')
rootgrp = Dataset("supernova.nc", "w", format="NETCDF4")
rootgrp.createDimension("x")
rootgrp.createDimension("y")
rootgrp.createDimension("z")
dim_0 = rootgrp.createVariable("supernova", np.float32, ("x","y","z"))
dim_0[:] = f['data']



'''
load_folder = os.path.join(FlowSTSR_folder_path, "TrainingData", "Supernova_raw")
save_folder = os.path.join(FlowSTSR_folder_path, "TrainingData", "Supernova")
i = 0
for filename in os.listdir(load_folder):
     print(filename)
     data = np.fromfile(os.path.join(load_folder, filename), dtype=np.float32)
     data = data.reshape([432, 432, 432])
     print(data.min())
     print(data.max())
     print(data.mean())
     #data = np.log10(1+data)
     data -= data.mean()
     data *= ( 1 / (max(data.max(), abs(data.min()))+1e-6))
     data = torch.tensor(data).unsqueeze(0).unsqueeze(0)
     data = F.interpolate(data, mode="trilinear", size=[448, 448, 448]).numpy()[0,0]

     f = h5py.File(os.path.join(save_folder, str(i)+".h5"), 'w')
     #f_data = np.array(f['data'])
     #oct_no = 0

     #f_data -= f_data.mean()
     #f_data *= (1 / (max(f_data.max(), abs(f_data.min()))+ 1e-6))
     #del f['data']
     f.create_dataset("data", data=np.expand_dims(data, 0)) 

     
     for z in range(0, f_data.shape[1], 128):
          for y in range(0, f_data.shape[2], 128):
               for x in range(0, f_data.shape[3], 128):
                    d = f_data[:,z:z+128,y:y+128,x:x+128]
                    f_h5_oct = h5py.File(os.path.join(save_folder, str(oct_no)+"_"+filename), 'w')
                    f_h5_oct.create_dataset("data", data=d)
                    f_h5_oct.close()
                    oct_no += 1
     

     f.close()
     i += 1
'''

'''
load_folder = os.path.join(FlowSTSR_folder_path, "TrainingData", "Combustion_raw")
save_folder = os.path.join(FlowSTSR_folder_path, "TrainingData", "Combustion_vort")

imgs = []
for i in range(1, 123):
     i_format = "%04d" % i
     folder = os.path.join(load_folder, "jet_"+i_format)
     load_name = "jet_vort_"+i_format+".dat"
     
     save_name = "%04d.h5" % (i-1)
     print("loading " + load_name)

     data = np.fromfile(os.path.join(load_folder, folder, load_name), dtype=np.float32)
     data = data.reshape([120, 720, 480])
     print(data.min())
     print(data.max())
     print(data.mean())
     data -= data.min()
     #data = np.log10(1+data)
     data = data / data.max()
     print(data.shape)
     data = torch.tensor(data).unsqueeze(0).unsqueeze(0)
     data = F.interpolate(data, mode='trilinear', size=[128, 768, 512])
     data = data[0].cpu().numpy()
     print(data.shape)

     imgs.append(data[0,64])
     print("saving " + save_name)
     f_h5 = h5py.File(os.path.join(save_folder, save_name), 'w')
     f_h5.create_dataset("data", data=data)
     f_h5.close()

print("Saving gif")
imageio.mimwrite("Combustion_vort.gif", imgs)
'''



'''
name = "dark_matter_density"
data = np.fromfile(os.path.join(FlowSTSR_folder_path, "InputData", "Nyx", name+".dat"), dtype=np.float32)
data = data.reshape([512, 512, 512])
print(data.min())
print(data.max())
print(data.mean())
data -= data.min()
data = np.log10(1+data)
data = data / data.max()
data -= data.mean()
data *= ( 1 / (max(data.max(), abs(data.min()))+1e-6))
print(data.shape)
rootgrp = Dataset(name+".nc", "w", format="NETCDF4")
rootgrp.createDimension("x")
rootgrp.createDimension("y")
rootgrp.createDimension("z")
dim_0 = rootgrp.createVariable(name, np.float32, ("x","y","z"))
dim_0[:] = data
'''

'''
results_powerspectrum = {
     "xs" : [0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0, 50.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0, 61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0, 73.0, 74.0, 75.0, 76.0, 77.0, 78.0, 79.0, 80.0, 81.0, 82.0, 83.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0, 90.0, 91.0, 92.0, 93.0, 94.0, 95.0, 96.0, 97.0, 98.0, 99.0, 100.0, 101.0, 102.0, 103.0, 104.0, 105.0, 106.0, 107.0, 108.0, 109.0, 110.0, 111.0, 112.0, 113.0, 114.0, 115.0, 116.0, 117.0, 118.0, 119.0, 120.0, 121.0, 122.0, 123.0, 124.0, 125.0, 126.0, 127.0, 128.0, 129.0, 130.0, 131.0, 132.0, 133.0, 134.0, 135.0, 136.0, 137.0, 138.0, 139.0, 140.0, 141.0, 142.0, 143.0, 144.0, 145.0, 146.0, 147.0, 148.0, 149.0, 150.0, 151.0, 152.0, 153.0, 154.0, 155.0, 156.0, 157.0, 158.0, 159.0, 160.0, 161.0, 162.0, 163.0, 164.0, 165.0, 166.0, 167.0, 168.0, 169.0, 170.0, 171.0, 172.0, 173.0, 174.0, 175.0, 176.0, 177.0, 178.0, 179.0, 180.0, 181.0, 182.0, 183.0, 184.0, 185.0, 186.0, 187.0, 188.0, 189.0, 190.0, 191.0, 192.0, 193.0, 194.0, 195.0, 196.0, 197.0, 198.0, 199.0, 200.0, 201.0, 202.0, 203.0, 204.0, 205.0, 206.0, 207.0, 208.0, 209.0, 210.0, 211.0, 212.0, 213.0, 214.0, 215.0, 216.0, 217.0, 218.0, 219.0, 220.0, 221.0, 222.0, 223.0, 224.0, 225.0, 226.0, 227.0, 228.0, 229.0, 230.0, 231.0, 232.0, 233.0, 234.0, 235.0, 236.0, 237.0, 238.0, 239.0, 240.0, 241.0, 242.0, 243.0, 244.0, 245.0, 246.0, 247.0, 248.0, 249.0, 250.0, 251.0, 252.0, 253.0, 254.0, 255.0, 256.0, 257.0, 258.0, 259.0, 260.0, 261.0, 262.0, 263.0, 264.0, 265.0, 266.0, 267.0, 268.0, 269.0, 270.0, 271.0, 272.0, 273.0, 274.0, 275.0, 276.0, 277.0, 278.0, 279.0, 280.0, 281.0, 282.0, 283.0, 284.0, 285.0, 286.0, 287.0, 288.0, 289.0, 290.0, 291.0, 292.0, 293.0, 294.0, 295.0, 296.0, 297.0, 298.0, 299.0, 300.0, 301.0, 302.0, 303.0, 304.0, 305.0, 306.0, 307.0, 308.0, 309.0, 310.0, 311.0, 312.0, 313.0, 314.0, 315.0, 316.0, 317.0, 318.0, 319.0, 320.0, 321.0, 322.0, 323.0, 324.0, 325.0, 326.0, 327.0, 328.0, 329.0, 330.0, 331.0, 332.0, 333.0, 334.0, 335.0, 336.0, 337.0, 338.0, 339.0, 340.0, 341.0, 342.0, 343.0, 344.0, 345.0, 346.0, 347.0, 348.0, 349.0, 350.0, 351.0, 352.0, 353.0, 354.0, 355.0, 356.0, 357.0, 358.0, 359.0, 360.0, 361.0, 362.0, 363.0, 364.0, 365.0, 366.0, 367.0, 368.0, 369.0, 370.0, 371.0, 372.0, 373.0, 374.0, 375.0, 376.0, 377.0, 378.0, 379.0, 380.0, 381.0, 382.0, 383.0, 384.0, 385.0, 386.0, 387.0, 388.0, 389.0, 390.0, 391.0, 392.0, 393.0, 394.0, 395.0, 396.0, 397.0, 398.0, 399.0, 400.0, 401.0, 402.0, 403.0, 404.0, 405.0, 406.0, 407.0, 408.0, 409.0, 410.0, 411.0, 412.0, 413.0, 414.0, 415.0, 416.0, 417.0, 418.0, 419.0, 420.0, 421.0, 422.0, 423.0, 424.0, 425.0, 426.0, 427.0, 428.0, 429.0, 430.0, 431.0, 432.0, 433.0, 434.0, 435.0, 436.0, 437.0, 438.0, 439.0, 440.0, 441.0, 442.0, 443.0, 444.0, 445.0, 446.0, 447.0, 448.0, 449.0, 450.0, 451.0, 452.0, 453.0, 454.0, 455.0, 456.0, 457.0, 458.0, 459.0, 460.0, 461.0, 462.0, 463.0, 464.0, 465.0, 466.0, 467.0, 468.0, 469.0, 470.0, 471.0, 472.0, 473.0, 474.0, 475.0, 476.0, 477.0, 478.0, 479.0, 480.0, 481.0, 482.0, 483.0, 484.0, 485.0, 486.0, 487.0, 488.0, 489.0, 490.0, 491.0, 492.0, 493.0, 494.0, 495.0, 496.0, 497.0, 498.0, 499.0, 500.0, 501.0, 502.0, 503.0, 504.0, 505.0, 506.0, 507.0, 508.0, 509.0, 510.0, 511.0],
     "Ground truth": [1.1190683841705322, 0.3420126140117645, 0.9333255887031555, 1.5620728731155396, 1.6811823844909668, 2.0471885204315186, 2.0127644538879395, 2.205718517303467, 2.3285107612609863, 2.538517951965332, 2.5047643184661865, 2.498236656188965, 2.514432907104492, 2.6636266708374023, 2.662963390350342, 2.8065056800842285, 2.864065647125244, 2.9518051147460938, 3.0031092166900635, 3.0606651306152344, 3.1099603176116943, 3.1896238327026367, 3.196472406387329, 3.265127182006836, 3.221163749694824, 3.3132147789001465, 3.384387493133545, 3.4574427604675293, 3.376142740249634, 3.4250850677490234, 3.466907024383545, 3.5291590690612793, 3.601930618286133, 3.6391797065734863, 3.601001739501953, 3.6566579341888428, 3.6933250427246094, 3.736211061477661, 3.7532618045806885, 3.854665756225586, 3.8566954135894775, 3.90645694732666, 3.891075611114502, 3.910860061645508, 3.9208781719207764, 3.9504170417785645, 3.9425199031829834, 3.991117238998413, 4.017868518829346, 4.0647430419921875, 4.067299842834473, 4.077878475189209, 4.05474328994751, 4.081634521484375, 4.050901889801025, 4.0634846687316895, 4.095348834991455, 4.094532012939453, 4.0956525802612305, 4.124024868011475, 4.126298904418945, 4.132656097412109, 4.0990495681762695, 4.15346097946167, 4.089120864868164, 4.131629943847656, 4.105545997619629, 4.0649189949035645, 4.097238540649414, 4.112988471984863, 4.083864212036133, 4.0850653648376465, 4.084239959716797, 4.14586877822876, 4.110552787780762, 4.0778398513793945, 4.0708417892456055, 4.077771186828613, 4.0268754959106445, 4.011659622192383, 4.011858940124512, 4.018866062164307, 4.013390064239502, 4.033783912658691, 3.999823808670044, 4.001452445983887, 3.9851107597351074, 3.9653677940368652, 3.925686836242676, 3.9554500579833984, 3.961393117904663, 3.916207790374756, 3.8985559940338135, 3.8903772830963135, 3.852931261062622, 3.8683061599731445, 3.854796886444092, 3.8557546138763428, 3.835136651992798, 3.811753988265991, 3.7835757732391357, 3.807292938232422, 3.7804579734802246, 3.7565386295318604, 3.749875068664551, 3.7290899753570557, 3.692688465118408, 3.7154173851013184, 3.68202805519104, 3.6697309017181396, 3.654149055480957, 3.6538758277893066, 3.6413869857788086, 3.6132185459136963, 3.5981738567352295, 3.591278314590454, 3.5696606636047363, 3.552767038345337, 3.524082660675049, 3.5163803100585938, 3.5020384788513184, 3.4951729774475098, 3.4604597091674805, 3.4652695655822754, 3.442308187484741, 3.431004524230957, 3.4016897678375244, 3.374783515930176, 3.372143507003784, 3.372366189956665, 3.34720778465271, 3.3294551372528076, 3.3186697959899902, 3.3201980590820312, 3.2724483013153076, 3.250406265258789, 3.2459616661071777, 3.2337632179260254, 3.210862159729004, 3.1972506046295166, 3.185260772705078, 3.178865432739258, 3.1517069339752197, 3.1460461616516113, 3.12481689453125, 3.1197800636291504, 3.093331813812256, 3.0784103870391846, 3.056544303894043, 3.0535006523132324, 3.031879186630249, 3.0087976455688477, 2.9976024627685547, 2.9956202507019043, 2.9708242416381836, 2.948726177215576, 2.9309027194976807, 2.9230315685272217, 2.917128801345825, 2.901489496231079, 2.872803211212158, 2.8735508918762207, 2.857450485229492, 2.830136299133301, 2.8179712295532227, 2.814012050628662, 2.7855384349823, 2.7807164192199707, 2.7613062858581543, 2.751081943511963, 2.741682291030884, 2.726741313934326, 2.704336643218994, 2.6901416778564453, 2.6726255416870117, 2.662313461303711, 2.641780376434326, 2.628110647201538, 2.6177759170532227, 2.6156134605407715, 2.5985188484191895, 2.578557252883911, 2.5638628005981445, 2.5618531703948975, 2.5376439094543457, 2.5236611366271973, 2.5087203979492188, 2.5025901794433594, 2.483574867248535, 2.4718785285949707, 2.455981731414795, 2.4522318840026855, 2.432283878326416, 2.418727397918701, 2.4100472927093506, 2.3955516815185547, 2.37978458404541, 2.3629322052001953, 2.3499863147735596, 2.346564292907715, 2.3332254886627197, 2.324185609817505, 2.3017940521240234, 2.293722152709961, 2.2805330753326416, 2.275031566619873, 2.266355037689209, 2.2468535900115967, 2.228368043899536, 2.22149658203125, 2.2054643630981445, 2.193699359893799, 2.18642520904541, 2.180067539215088, 2.1603341102600098, 2.1440157890319824, 2.1316323280334473, 2.124614715576172, 2.1163768768310547, 2.105872869491577, 2.089383363723755, 2.0855250358581543, 2.068859815597534, 2.057668447494507, 2.0414881706237793, 2.032466411590576, 2.020662307739258, 2.013077735900879, 2.0018367767333984, 1.993006944656372, 1.9785138368606567, 1.969189167022705, 1.95833420753479, 1.9510802030563354, 1.9384760856628418, 1.9260565042495728, 1.9182871580123901, 1.9099781513214111, 1.8929193019866943, 1.8888294696807861, 1.8793785572052002, 1.8702912330627441, 1.8617284297943115, 1.8521543741226196, 1.8379478454589844, 1.8265902996063232, 1.8141100406646729, 1.8109724521636963, 1.7976315021514893, 1.7858699560165405, 1.77964448928833, 1.7742376327514648, 1.7610981464385986, 1.7476470470428467, 1.7410534620285034, 1.733888030052185, 1.7177059650421143, 1.711566686630249, 1.7022755146026611, 1.6938519477844238, 1.683475375175476, 1.6756837368011475, 1.66288423538208, 1.658718466758728, 1.6499748229980469, 1.6431115865707397, 1.6306805610656738, 1.6191924810409546, 1.6145540475845337, 1.6099400520324707, 1.595442771911621, 1.5885342359542847, 1.5823520421981812, 1.5738065242767334, 1.5614428520202637, 1.5527968406677246, 1.5471256971359253, 1.537325143814087, 1.5250238180160522, 1.5206549167633057, 1.5111960172653198, 1.5057361125946045, 1.4965167045593262, 1.490788459777832, 1.4815080165863037, 1.4746391773223877, 1.4640076160430908, 1.457160234451294, 1.448843002319336, 1.4422194957733154, 1.434809684753418, 1.4261173009872437, 1.4200022220611572, 1.4154033660888672, 1.4036798477172852, 1.393580675125122, 1.3865587711334229, 1.3800013065338135, 1.3716802597045898, 1.3671883344650269, 1.3590185642242432, 1.3514574766159058, 1.3467581272125244, 1.3412702083587646, 1.3284497261047363, 1.325471043586731, 1.3168408870697021, 1.3105382919311523, 1.3025895357131958, 1.2964926958084106, 1.2893784046173096, 1.2835643291473389, 1.276824712753296, 1.2680318355560303, 1.263905644416809, 1.258460521697998, 1.2467734813690186, 1.2420029640197754, 1.234485149383545, 1.2292991876602173, 1.2234277725219727, 1.2177150249481201, 1.2119454145431519, 1.2068240642547607, 1.197357416152954, 1.1922489404678345, 1.1870543956756592, 1.1797062158584595, 1.171940803527832, 1.1681784391403198, 1.161798119544983, 1.15366530418396, 1.146681547164917, 1.1455373764038086, 1.1367378234863281, 1.1318409442901611, 1.1273504495620728, 1.1197967529296875, 1.1149868965148926, 1.1098885536193848, 1.1020715236663818, 1.0972886085510254, 1.0892186164855957, 1.0862195491790771, 1.0812530517578125, 1.0765764713287354, 1.0699241161346436, 1.0631858110427856, 1.0596129894256592, 1.0557236671447754, 1.0486197471618652, 1.042668342590332, 1.0372450351715088, 1.0340666770935059, 1.026733636856079, 1.023666262626648, 1.0181037187576294, 1.0113698244094849, 1.0057456493377686, 1.001365065574646, 0.9977527856826782, 0.9932143092155457, 0.988821804523468, 0.9849964380264282, 0.9771963357925415, 0.97525954246521, 0.9684959650039673, 0.9636805057525635, 0.9594756960868835, 0.9553160667419434, 0.9498395919799805, 0.9436156749725342, 0.9402933120727539, 0.9379162788391113, 0.9327365159988403, 0.9280365705490112, 0.9213746786117554, 0.9198072552680969, 0.9153320789337158, 0.909796953201294, 0.9058825969696045, 0.9016543030738831, 0.8976033329963684, 0.8946702480316162, 0.8910138607025146, 0.8878934383392334, 0.8817130327224731, 0.8781323432922363, 0.8737807273864746, 0.8715190887451172, 0.866780161857605, 0.8626649379730225, 0.860140860080719, 0.8559972643852234, 0.8512244820594788, 0.8483637571334839, 0.8452695608139038, 0.8412681818008423, 0.8377372026443481, 0.8345264196395874, 0.8293238878250122, 0.8290265798568726, 0.8246049284934998, 0.8204882144927979, 0.8184759616851807, 0.8162283897399902, 0.8110785484313965, 0.8082807064056396, 0.8076949119567871, 0.8048509359359741, 0.7995688915252686, 0.7971093654632568, 0.7940529584884644, 0.7921943664550781, 0.7880988121032715, 0.7861512899398804, 0.7832455635070801, 0.7797336578369141, 0.7787905335426331, 0.7774345874786377, 0.7742193341255188, 0.77223140001297, 0.7704635858535767, 0.7684988379478455, 0.7648189663887024, 0.7648065090179443, 0.7629718780517578, 0.7606545686721802, 0.7585764527320862, 0.7572806477546692, 0.7546086311340332, 0.7538478374481201, 0.7529914975166321, 0.7520278692245483, 0.7515685558319092, 0.7493504285812378, 0.7462525367736816, 0.7479411363601685, 0.7471016049385071, 0.7466188669204712, 0.7458482980728149, 0.7455189228057861, 0.7447053790092468, 0.7445083856582642, 0.7447601556777954, 0.7460190057754517, 0.7449151277542114, 0.7455974221229553, 0.7451785206794739, 0.7469951510429382, 0.7494481801986694, 0.7494547367095947, 0.7504644989967346, 0.7523459792137146, 0.7533676028251648, 0.7557471990585327, 0.7569328546524048, 0.7594692707061768, 0.7615477442741394, 0.7657470107078552, 0.7682344913482666, 0.7709678411483765, 0.7746517062187195, 0.7800387740135193, 0.7848511934280396, 0.7890198230743408, 0.7936344146728516, 0.7995954155921936, 0.8055813908576965, 0.8128366470336914, 0.8191878795623779, 0.8277574777603149, 0.8362009525299072, 0.8454173803329468, 0.8551415205001831, 0.8661440014839172, 0.8768675327301025, 0.8884624242782593, 0.9010363221168518, 0.918041467666626, 0.9367120265960693, 0.9509989023208618, 0.9254101514816284, 0.8328577280044556, 0.6971551179885864, 0.59366774559021, 0.5412344932556152, 0.5084195733070374, 0.4840403199195862, 0.46631577610969543, 0.45144525170326233, 0.4398314654827118, 0.43015772104263306, 0.42178037762641907, 0.4137604534626007, 0.4069886803627014, 0.40074673295021057, 0.395257830619812, 0.38960590958595276, 0.38429105281829834, 0.3801017105579376, 0.3757082223892212, 0.37125539779663086, 0.3681381642818451, 0.3640318214893341, 0.36089059710502625, 0.3572271466255188, 0.35398179292678833, 0.35095149278640747, 0.3481188416481018, 0.34498322010040283, 0.3427697420120239],
     "Ours": [1.1153228282928467, 0.34090104699134827, 0.9304943680763245, 1.5573272705078125, 1.6758836507797241, 2.0408053398132324, 2.006425142288208, 2.1985116004943848, 2.320852756500244, 2.5305397510528564, 2.496875047683716, 2.4901957511901855, 2.506537675857544, 2.655010938644409, 2.6539340019226074, 2.7967591285705566, 2.854279041290283, 2.9418861865997314, 2.9931249618530273, 3.0504517555236816, 3.0996084213256836, 3.178816795349121, 3.1851437091827393, 3.2540173530578613, 3.210718870162964, 3.3019816875457764, 3.373905658721924, 3.4469873905181885, 3.365607261657715, 3.414923667907715, 3.456472635269165, 3.5185256004333496, 3.5911662578582764, 3.6282572746276855, 3.59013032913208, 3.6463606357574463, 3.683981418609619, 3.7290332317352295, 3.7451581954956055, 3.8440325260162354, 3.847442626953125, 3.897752046585083, 3.883057117462158, 3.906029224395752, 3.9152119159698486, 3.9427499771118164, 3.936728000640869, 3.9846973419189453, 4.010962963104248, 4.057991981506348, 4.0607829093933105, 4.071920394897461, 4.047878265380859, 4.076672554016113, 4.046592712402344, 4.058632850646973, 4.090663909912109, 4.090540885925293, 4.090915203094482, 4.118472099304199, 4.120879173278809, 4.12725830078125, 4.096337795257568, 4.151799201965332, 4.08836555480957, 4.13215446472168, 4.10634708404541, 4.064346790313721, 4.095883369445801, 4.112642288208008, 4.084968566894531, 4.086372375488281, 4.085682392120361, 4.147841453552246, 4.11374044418335, 4.08182954788208, 4.079225540161133, 4.088042736053467, 4.035247802734375, 4.021348476409912, 4.022994518280029, 4.02926778793335, 4.022043228149414, 4.0482635498046875, 4.017740249633789, 4.017524242401123, 4.002788543701172, 3.9826741218566895, 3.9433817863464355, 3.981473445892334, 3.9912376403808594, 3.944359302520752, 3.9277195930480957, 3.923551559448242, 3.888425350189209, 3.9035427570343018, 3.891080141067505, 3.8936822414398193, 3.8742923736572266, 3.8523356914520264, 3.8271563053131104, 3.849806308746338, 3.8199501037597656, 3.795869827270508, 3.7883427143096924, 3.770404100418091, 3.732848644256592, 3.754577159881592, 3.7169692516326904, 3.7038183212280273, 3.6884007453918457, 3.6786253452301025, 3.659703016281128, 3.6306939125061035, 3.6139280796051025, 3.5972037315368652, 3.5640182495117188, 3.5416903495788574, 3.507223606109619, 3.499530792236328, 3.48062801361084, 3.4627771377563477, 3.4176933765411377, 3.408714532852173, 3.3786826133728027, 3.355195999145508, 3.3076860904693604, 3.2773783206939697, 3.269092559814453, 3.2521603107452393, 3.214777946472168, 3.18684720993042, 3.15631103515625, 3.1373634338378906, 3.0841126441955566, 3.047171115875244, 3.0256576538085938, 3.001328468322754, 2.9589123725891113, 2.9159340858459473, 2.8838462829589844, 2.8604300022125244, 2.8156261444091797, 2.7942371368408203, 2.747051239013672, 2.7138137817382812, 2.670997381210327, 2.6312925815582275, 2.590864896774292, 2.564603567123413, 2.521679162979126, 2.47790789604187, 2.4420883655548096, 2.416328191757202, 2.368852138519287, 2.3216724395751953, 2.2812752723693848, 2.2469561100006104, 2.2083239555358887, 2.1667633056640625, 2.118393659591675, 2.0920870304107666, 2.0534658432006836, 2.0046892166137695, 1.9649662971496582, 1.9365615844726562, 1.888371467590332, 1.8534724712371826, 1.813797950744629, 1.7801812887191772, 1.7457194328308105, 1.70719313621521, 1.671086072921753, 1.638359546661377, 1.60001802444458, 1.5695774555206299, 1.533945083618164, 1.5016539096832275, 1.4650049209594727, 1.4411805868148804, 1.410683035850525, 1.376370906829834, 1.3433935642242432, 1.3191940784454346, 1.2900049686431885, 1.2610714435577393, 1.2302417755126953, 1.2054611444473267, 1.1760773658752441, 1.1485674381256104, 1.1211044788360596, 1.1028622388839722, 1.0798556804656982, 1.0536324977874756, 1.0297801494598389, 1.00953209400177, 0.9869029521942139, 0.9602900147438049, 0.9374580383300781, 0.9174153208732605, 0.8955039381980896, 0.8792177438735962, 0.8594746589660645, 0.8422635793685913, 0.8203250169754028, 0.8051974773406982, 0.7877455949783325, 0.7678631544113159, 0.749730110168457, 0.7361254692077637, 0.7218165397644043, 0.7057351469993591, 0.6909279227256775, 0.679057776927948, 0.6636543273925781, 0.6493905782699585, 0.6355352401733398, 0.6247724294662476, 0.6135773062705994, 0.6006838083267212, 0.5882638096809387, 0.5807201862335205, 0.5683357119560242, 0.5572512149810791, 0.5483596920967102, 0.5400669574737549, 0.5283457040786743, 0.5201305150985718, 0.5123773813247681, 0.5048538446426392, 0.4954215884208679, 0.48746538162231445, 0.4800589978694916, 0.4743598699569702, 0.46617409586906433, 0.4590623080730438, 0.4532712697982788, 0.44650328159332275, 0.43933895230293274, 0.43494218587875366, 0.4298359453678131, 0.4246175289154053, 0.4195297658443451, 0.415266752243042, 0.40991103649139404, 0.40447118878364563, 0.39901694655418396, 0.3962525725364685, 0.39106887578964233, 0.386704683303833, 0.3837285041809082, 0.3807882070541382, 0.3760018050670624, 0.3721970319747925, 0.3696250021457672, 0.36673808097839355, 0.3622777462005615, 0.35973986983299255, 0.3576853275299072, 0.35531824827194214, 0.352448046207428, 0.35022327303886414, 0.3471429944038391, 0.3462942838668823, 0.3442196846008301, 0.3433523178100586, 0.34128111600875854, 0.3384576439857483, 0.3376944959163666, 0.33681434392929077, 0.3337528705596924, 0.33340197801589966, 0.33275824785232544, 0.33121222257614136, 0.32958775758743286, 0.32840844988822937, 0.3276406526565552, 0.32626813650131226, 0.3249896168708801, 0.32487475872039795, 0.32280296087265015, 0.32224124670028687, 0.3210645914077759, 0.32047122716903687, 0.3192417621612549, 0.3181474804878235, 0.3160315155982971, 0.3153911828994751, 0.3146517276763916, 0.3135589063167572, 0.3125459849834442, 0.31119486689567566, 0.30966514348983765, 0.3093380928039551, 0.30769842863082886, 0.3065149784088135, 0.3054748475551605, 0.3045114576816559, 0.3031247854232788, 0.30188876390457153, 0.30010342597961426, 0.2989503741264343, 0.2982436418533325, 0.2971932888031006, 0.29501110315322876, 0.29465359449386597, 0.29316025972366333, 0.29215922951698303, 0.29055124521255493, 0.28896310925483704, 0.28788793087005615, 0.28697723150253296, 0.2854756712913513, 0.28388339281082153, 0.28250908851623535, 0.2812078893184662, 0.27883782982826233, 0.277726411819458, 0.2758181691169739, 0.2740240693092346, 0.2723538875579834, 0.2712932825088501, 0.2695227563381195, 0.2675762474536896, 0.265394926071167, 0.2640475332736969, 0.26242145895957947, 0.2606334090232849, 0.25847649574279785, 0.2570120692253113, 0.2550842761993408, 0.25285786390304565, 0.2507804036140442, 0.2497207671403885, 0.24733400344848633, 0.24500975012779236, 0.2432435154914856, 0.24159389734268188, 0.23940923810005188, 0.23743754625320435, 0.23546430468559265, 0.23370173573493958, 0.23107978701591492, 0.2296576350927353, 0.22751715779304504, 0.22556769847869873, 0.22350920736789703, 0.2212245762348175, 0.2196393758058548, 0.21803191304206848, 0.21571755409240723, 0.213881254196167, 0.21181795001029968, 0.21047206223011017, 0.2082580029964447, 0.20665214955806732, 0.20481657981872559, 0.202865332365036, 0.20101895928382874, 0.19924373924732208, 0.19771181046962738, 0.19587865471839905, 0.19445990025997162, 0.1931648701429367, 0.19073542952537537, 0.18941225111484528, 0.1872359812259674, 0.1856788992881775, 0.18424083292484283, 0.18266473710536957, 0.18082359433174133, 0.17901328206062317, 0.17771995067596436, 0.1763811707496643, 0.17479191720485687, 0.17346076667308807, 0.17155960202217102, 0.17053812742233276, 0.16937805712223053, 0.1678336262702942, 0.16652624309062958, 0.1652628630399704, 0.16423648595809937, 0.16327372193336487, 0.16181880235671997, 0.16084891557693481, 0.15929532051086426, 0.1581839919090271, 0.15716151893138885, 0.1565023809671402, 0.1552121490240097, 0.154057577252388, 0.15326741337776184, 0.15239381790161133, 0.15136146545410156, 0.15054181218147278, 0.1497347503900528, 0.14888013899326324, 0.14802473783493042, 0.14726915955543518, 0.14606109261512756, 0.14556919038295746, 0.14463719725608826, 0.14386232197284698, 0.14328238368034363, 0.14262837171554565, 0.14163267612457275, 0.14101764559745789, 0.14057859778404236, 0.13993299007415771, 0.1391335427761078, 0.13869091868400574, 0.13792432844638824, 0.1372213065624237, 0.13645437359809875, 0.13610398769378662, 0.13545837998390198, 0.13474208116531372, 0.13437873125076294, 0.1339283585548401, 0.13320046663284302, 0.132838636636734, 0.13239337503910065, 0.13194067776203156, 0.13123728334903717, 0.1311550885438919, 0.13078373670578003, 0.130154550075531, 0.1296483725309372, 0.1294194608926773, 0.12897707521915436, 0.12878157198429108, 0.12839968502521515, 0.12813791632652283, 0.12794016301631927, 0.127616286277771, 0.12715895473957062, 0.12721049785614014, 0.12672457098960876, 0.12648063898086548, 0.12652838230133057, 0.12635426223278046, 0.12599827349185944, 0.12594787776470184, 0.12578772008419037, 0.12594535946846008, 0.12584179639816284, 0.12572622299194336, 0.1253417581319809, 0.12534385919570923, 0.12552067637443542, 0.12552782893180847, 0.1254911720752716, 0.12551414966583252, 0.12537963688373566, 0.12546998262405396, 0.12544065713882446, 0.12555497884750366, 0.1255529522895813, 0.12559042870998383, 0.1255866140127182, 0.12576580047607422, 0.12582141160964966, 0.1259608268737793, 0.12607309222221375, 0.12626877427101135, 0.12627995014190674, 0.12640318274497986, 0.1264580935239792, 0.12670743465423584, 0.126683309674263, 0.12687517702579498, 0.12701520323753357, 0.12725453078746796, 0.1273999810218811, 0.12762989103794098, 0.12778374552726746, 0.12795989215373993, 0.1280672550201416, 0.12846659123897552, 0.1287492960691452, 0.1290655881166458, 0.1292874813079834, 0.1296805441379547, 0.12978419661521912, 0.13002178072929382, 0.13022078573703766, 0.13058802485466003, 0.13087955117225647, 0.13125506043434143, 0.13132280111312866, 0.13167330622673035, 0.13202489912509918, 0.1323847472667694, 0.13260358572006226, 0.13301017880439758, 0.13318505883216858, 0.13359428942203522, 0.1339586079120636, 0.13416869938373566, 0.134586900472641, 0.13489389419555664, 0.1350838541984558, 0.1355653554201126, 0.13578404486179352, 0.13623575866222382, 0.13661232590675354, 0.1370251476764679, 0.13739144802093506, 0.13773508369922638, 0.13797834515571594, 0.13846638798713684],
     "SR-octree":[2.17677903175354, 3.104686737060547, 4.043375015258789, 4.037208557128906, 4.919696807861328, 5.874845504760742, 6.2145538330078125, 6.847893714904785, 7.0682477951049805, 7.276698589324951, 7.544886589050293, 7.74085807800293, 7.777347087860107, 7.984922409057617, 8.12092399597168, 8.410907745361328, 8.589017868041992, 8.80884838104248, 9.000163078308105, 9.18309497833252, 9.34698486328125, 9.463083267211914, 9.539694786071777, 9.696228981018066, 9.7568941116333, 9.933374404907227, 9.937393188476562, 10.075197219848633, 10.151405334472656, 10.271442413330078, 10.316315650939941, 10.415536880493164, 10.535900115966797, 10.610088348388672, 10.73361587524414, 10.794353485107422, 10.822015762329102, 10.972721099853516, 11.053365707397461, 11.175329208374023, 11.213326454162598, 11.322216033935547, 11.321980476379395, 11.381351470947266, 11.37746524810791, 11.416399002075195, 11.463138580322266, 11.52442741394043, 11.55345344543457, 11.60187816619873, 11.626443862915039, 11.648893356323242, 11.609807014465332, 11.608047485351562, 11.581705093383789, 11.57864761352539, 11.59166431427002, 11.564367294311523, 11.611806869506836, 11.585509300231934, 11.54958724975586, 11.591119766235352, 11.512060165405273, 11.541635513305664, 11.442058563232422, 11.432317733764648, 11.370356559753418, 11.346770286560059, 11.323681831359863, 11.246341705322266, 11.24929428100586, 11.263555526733398, 11.189676284790039, 11.172561645507812, 11.127989768981934, 11.109527587890625, 11.025104522705078, 10.93754768371582, 10.87304973602295, 10.828706741333008, 10.773083686828613, 10.73055648803711, 10.691869735717773, 10.672197341918945, 10.602753639221191, 10.565139770507812, 10.472122192382812, 10.436323165893555, 10.384164810180664, 10.307401657104492, 10.244791030883789, 10.187444686889648, 10.133800506591797, 10.053133010864258, 9.98469066619873, 9.944353103637695, 9.868850708007812, 9.82454776763916, 9.760875701904297, 9.713533401489258, 9.636054992675781, 9.573599815368652, 9.500782012939453, 9.448432922363281, 9.378438949584961, 9.313541412353516, 9.23959732055664, 9.18528938293457, 9.09572982788086, 9.068514823913574, 8.998703956604004, 8.928522109985352, 8.880106925964355, 8.817352294921875, 8.758609771728516, 8.687564849853516, 8.623149871826172, 8.560752868652344, 8.500204086303711, 8.43880844116211, 8.361600875854492, 8.317346572875977, 8.25059700012207, 8.209114074707031, 8.130905151367188, 8.076295852661133, 8.017139434814453, 7.965965747833252, 7.907797813415527, 7.84065580368042, 7.799917697906494, 7.758687973022461, 7.68281364440918, 7.627373218536377, 7.573716163635254, 7.519899368286133, 7.457916259765625, 7.397641181945801, 7.358355522155762, 7.32036828994751, 7.266603469848633, 7.226200103759766, 7.178731441497803, 7.144039154052734, 7.082544326782227, 7.045069694519043, 6.994504928588867, 6.961493015289307, 6.912945747375488, 6.869272232055664, 6.82679557800293, 6.802300453186035, 6.76731014251709, 6.724225044250488, 6.694716453552246, 6.665427207946777, 6.637665271759033, 6.601127624511719, 6.570601463317871, 6.55035400390625, 6.521780967712402, 6.493141174316406, 6.459081649780273, 6.441119194030762, 6.4113569259643555, 6.389740467071533, 6.367619514465332, 6.360256195068359, 6.339751243591309, 6.32916259765625, 6.317852973937988, 6.301746368408203, 6.2907280921936035, 6.273906707763672, 6.252493858337402, 6.241593837738037, 6.233564376831055, 6.2279157638549805, 6.2212419509887695, 6.213734149932861, 6.20947790145874, 6.22147274017334, 6.211834907531738, 6.213722229003906, 6.207303524017334, 6.221661567687988, 6.212750434875488, 6.214476108551025, 6.21366024017334, 6.223293781280518, 6.221900463104248, 6.224071025848389, 6.22590446472168, 6.234245300292969, 6.237458229064941, 6.233868598937988, 6.241415023803711, 6.249100685119629, 6.248523235321045, 6.256603240966797, 6.259876251220703, 6.273702621459961, 6.27950382232666, 6.289096832275391, 6.293007850646973, 6.297235488891602, 6.301527500152588, 6.298032760620117, 6.297462463378906, 6.294023513793945, 6.291060447692871, 6.304028511047363, 6.300370693206787, 6.30103063583374, 6.298976421356201, 6.296726226806641, 6.291236400604248, 6.282033443450928, 6.275025367736816, 6.267657279968262, 6.258029937744141, 6.253689289093018, 6.23329496383667, 6.222102642059326, 6.199103832244873, 6.181999683380127, 6.157290458679199, 6.129861831665039, 6.096798419952393, 6.0693511962890625, 6.038651466369629, 6.005161285400391, 5.967451095581055, 5.922616958618164, 5.8816070556640625, 5.838935852050781, 5.783500671386719, 5.735221862792969, 5.679076194763184, 5.627633094787598, 5.560635566711426, 5.496788024902344, 5.427298545837402, 5.342999458312988, 5.254882335662842, 5.17019510269165, 5.070696830749512, 4.9738569259643555, 4.871763229370117, 4.771126747131348, 4.658448219299316, 4.535346984863281, 4.411426544189453, 4.275084018707275, 4.1309332847595215, 4.0061116218566895, 3.914379119873047, 3.8543171882629395, 3.821730852127075, 3.8338818550109863, 3.8677101135253906, 3.9125382900238037, 3.9539642333984375, 4.002926826477051, 4.0449371337890625, 4.090041637420654, 4.138810634613037, 4.185399532318115, 4.234495162963867, 4.282010555267334, 4.3295440673828125, 4.379822731018066, 4.421647071838379, 4.465240955352783, 4.506595611572266, 4.540782928466797, 4.575828552246094, 4.611869812011719, 4.645750522613525, 4.678774833679199, 4.708827972412109, 4.747437477111816, 4.7737274169921875, 4.807931900024414, 4.831366539001465, 4.85777473449707, 4.8805317878723145, 4.900992393493652, 4.919943332672119, 4.936578273773193, 4.956294536590576, 4.975931644439697, 4.987401008605957, 5.0027666091918945, 5.011504650115967, 5.023746490478516, 5.032135963439941, 5.037472724914551, 5.047362327575684, 5.051031589508057, 5.057233810424805, 5.061892986297607, 5.061836242675781, 5.067837715148926, 5.067499160766602, 5.074305534362793, 5.0682053565979, 5.072011470794678, 5.070659637451172, 5.067062854766846, 5.064232349395752, 5.062520980834961, 5.061490058898926, 5.058897972106934, 5.058325290679932, 5.0545244216918945, 5.05312442779541, 5.048454284667969, 5.037303447723389, 5.040555477142334, 5.036755084991455, 5.039066314697266, 5.034225940704346, 5.033823013305664, 5.037308216094971, 5.036977767944336, 5.034346103668213, 5.034607410430908, 5.038334846496582, 5.03901481628418, 5.036465644836426, 5.045547008514404, 5.048652648925781, 5.05712890625, 5.063508987426758, 5.075639724731445, 5.085427284240723, 5.094447612762451, 5.106485843658447, 5.114947319030762, 5.125388145446777, 5.1417999267578125, 5.154247283935547, 5.1744208335876465, 5.18792724609375, 5.207650661468506, 5.229397773742676, 5.250720024108887, 5.271365165710449, 5.293094635009766, 5.319616794586182, 5.347279071807861, 5.3690032958984375, 5.396540641784668, 5.420563697814941, 5.449283599853516, 5.474859237670898, 5.501993179321289, 5.533157825469971, 5.559548377990723, 5.590087890625, 5.621253967285156, 5.648688316345215, 5.678748607635498, 5.698730945587158, 5.727315902709961, 5.745884895324707, 5.771259307861328, 5.7925214767456055, 5.8118896484375, 5.838423252105713, 5.859399795532227, 5.8812761306762695, 5.905402660369873, 5.925880432128906, 5.955153942108154, 5.977754592895508, 6.005517959594727, 6.02662467956543, 6.052084922790527, 6.0818281173706055, 6.108105182647705, 6.13942813873291, 6.16900634765625, 6.197851657867432, 6.232394695281982, 6.262883186340332, 6.296454429626465, 6.319486618041992, 6.351753234863281, 6.381895065307617, 6.415424823760986, 6.443106651306152, 6.472728729248047, 6.512679100036621, 6.546327590942383, 6.583624839782715, 6.619935512542725, 6.654709815979004, 6.691723823547363, 6.724106788635254, 6.764636993408203, 6.7952985763549805, 6.840662479400635, 6.880825996398926, 6.916048526763916, 6.9608259201049805, 7.000340461730957, 7.038213729858398, 7.080545425415039, 7.117116928100586, 7.1634440422058105, 7.197575569152832, 7.242242813110352, 7.280797958374023, 7.32054328918457, 7.366442680358887, 7.4085798263549805, 7.4543046951293945, 7.496654510498047, 7.541134357452393, 7.584671974182129, 7.6252007484436035, 7.673555374145508, 7.71476411819458, 7.759086608886719, 7.8000168800354, 7.84334135055542, 7.881185054779053, 7.916384696960449, 7.9546966552734375, 7.992111682891846, 8.031181335449219, 8.076112747192383, 8.114800453186035, 8.159378051757812, 8.196464538574219, 8.238592147827148, 8.276259422302246, 8.319649696350098, 8.355762481689453, 8.391340255737305, 8.430968284606934, 8.470632553100586, 8.500429153442383, 8.538912773132324, 8.567869186401367, 8.603072166442871, 8.634054183959961, 8.664288520812988, 8.690605163574219, 8.71954345703125, 8.751075744628906, 8.771533012390137, 8.790977478027344, 8.815882682800293, 8.832954406738281, 8.855300903320312, 8.868273735046387, 8.889711380004883, 8.905672073364258, 8.920380592346191, 8.931053161621094, 8.941938400268555, 8.953032493591309, 8.960453033447266, 8.966425895690918, 8.966469764709473, 8.962377548217773, 8.963920593261719, 8.95942497253418, 8.946266174316406, 8.930642127990723, 8.920928955078125, 8.900790214538574, 8.878737449645996, 8.849403381347656, 8.828131675720215, 8.79581356048584, 8.76168441772461, 8.722474098205566, 8.68349552154541, 8.640190124511719, 8.5897798538208, 8.537193298339844, 8.476903915405273, 8.405702590942383, 8.338116645812988, 8.260357856750488, 8.182703018188477, 8.100356101989746, 8.015028953552246, 7.922852516174316, 7.824296951293945, 7.716063499450684, 7.601341247558594, 7.478263854980469, 7.349638938903809, 7.216497421264648, 7.072693824768066, 6.924648284912109, 6.76527214050293, 6.596034049987793, 6.420612335205078, 6.227963447570801, 6.034524917602539, 5.822513580322266, 5.598674774169922, 5.357320308685303, 5.093730449676514, 4.806214809417725, 4.531240463256836],
     "SZ": [1.1190619468688965, 0.34201210737228394, 0.9333475828170776, 1.5620157718658447, 1.681032419204712, 2.0469706058502197, 2.0127103328704834, 2.206033706665039, 2.328901767730713, 2.538883686065674, 2.504638195037842, 2.4975924491882324, 2.5137884616851807, 2.663048028945923, 2.66184663772583, 2.805690050125122, 2.863844871520996, 2.9515700340270996, 3.002574920654297, 3.05953311920166, 3.107973337173462, 3.1872987747192383, 3.193516254425049, 3.2624454498291016, 3.2178006172180176, 3.308588981628418, 3.379387855529785, 3.4514007568359375, 3.369500160217285, 3.4174001216888428, 3.457951307296753, 3.5173583030700684, 3.5882511138916016, 3.623811960220337, 3.5844874382019043, 3.639864921569824, 3.674999713897705, 3.713590621948242, 3.72645902633667, 3.8242640495300293, 3.824152946472168, 3.87026309967041, 3.8501853942871094, 3.8670477867126465, 3.87192440032959, 3.8959081172943115, 3.8859715461730957, 3.929947853088379, 3.9506988525390625, 3.9905550479888916, 3.984234571456909, 3.989090919494629, 3.9621353149414062, 3.9815280437469482, 3.9457390308380127, 3.9499614238739014, 3.9740636348724365, 3.9659032821655273, 3.9558870792388916, 3.9726500511169434, 3.965010643005371, 3.961996555328369, 3.920492172241211, 3.961965560913086, 3.888455390930176, 3.9148354530334473, 3.8792693614959717, 3.8292994499206543, 3.846773386001587, 3.8487887382507324, 3.8078389167785645, 3.797238826751709, 3.7817800045013428, 3.8223776817321777, 3.774991512298584, 3.730078935623169, 3.705967426300049, 3.697174549102783, 3.6367387771606445, 3.6035876274108887, 3.5847620964050293, 3.574397325515747, 3.5516433715820312, 3.547213554382324, 3.4986047744750977, 3.480088472366333, 3.4480583667755127, 3.412999153137207, 3.358727216720581, 3.363582134246826, 3.3452863693237305, 3.2854080200195312, 3.249812364578247, 3.224419593811035, 3.172354221343994, 3.1627469062805176, 3.1287827491760254, 3.1047301292419434, 3.065045118331909, 3.0283141136169434, 2.9875917434692383, 2.980961322784424, 2.933614730834961, 2.894111156463623, 2.8704631328582764, 2.8376266956329346, 2.7843897342681885, 2.7737069129943848, 2.7284021377563477, 2.698416233062744, 2.668336868286133, 2.644864797592163, 2.613569736480713, 2.577439308166504, 2.5467350482940674, 2.516451835632324, 2.479862928390503, 2.451566219329834, 2.4199094772338867, 2.3976221084594727, 2.3656129837036133, 2.3447184562683105, 2.3087923526763916, 2.298741102218628, 2.2678747177124023, 2.246103286743164, 2.211454391479492, 2.1820895671844482, 2.1698617935180664, 2.1587369441986084, 2.1336708068847656, 2.10846209526062, 2.091322898864746, 2.0862746238708496, 2.0507583618164062, 2.0341908931732178, 2.026151180267334, 2.013186454772949, 1.9952553510665894, 1.977057695388794, 1.9700067043304443, 1.9659950733184814, 1.9434460401535034, 1.9407951831817627, 1.9257279634475708, 1.920248031616211, 1.9045746326446533, 1.896983027458191, 1.8830678462982178, 1.8751592636108398, 1.8624513149261475, 1.8502843379974365, 1.8464475870132446, 1.8492474555969238, 1.8319069147109985, 1.814847707748413, 1.8049674034118652, 1.8076651096343994, 1.8015028238296509, 1.789158582687378, 1.7714269161224365, 1.7646206617355347, 1.7562837600708008, 1.740386962890625, 1.7293846607208252, 1.72336745262146, 1.6951992511749268, 1.6874486207962036, 1.6726592779159546, 1.6632044315338135, 1.6531035900115967, 1.6374624967575073, 1.6177810430526733, 1.5999736785888672, 1.5852718353271484, 1.5754683017730713, 1.559812307357788, 1.5473434925079346, 1.5335639715194702, 1.532987117767334, 1.5183902978897095, 1.5057533979415894, 1.5027167797088623, 1.5002946853637695, 1.4879395961761475, 1.4833570718765259, 1.4836971759796143, 1.484024167060852, 1.4773701429367065, 1.4800664186477661, 1.476729393005371, 1.4892044067382812, 1.4902658462524414, 1.4929455518722534, 1.5034515857696533, 1.5082266330718994, 1.5139641761779785, 1.5147325992584229, 1.5236027240753174, 1.5412383079528809, 1.5489773750305176, 1.5626559257507324, 1.5696327686309814, 1.58928644657135, 1.5965263843536377, 1.6088354587554932, 1.6241027116775513, 1.631760597229004, 1.6459665298461914, 1.6623057126998901, 1.6740193367004395, 1.6926474571228027, 1.7119553089141846, 1.7354670763015747, 1.742661952972412, 1.755727767944336, 1.7755937576293945, 1.7953863143920898, 1.8119704723358154, 1.830310583114624, 1.8414878845214844, 1.8616740703582764, 1.8796923160552979, 1.8994557857513428, 1.9166967868804932, 1.9364278316497803, 1.9453483819961548, 1.965328335762024, 1.978123426437378, 1.996690034866333, 2.015673875808716, 2.033355951309204, 2.0503053665161133, 2.0690176486968994, 2.076859951019287, 2.0888333320617676, 2.101884603500366, 2.1133601665496826, 2.120739459991455, 2.132235527038574, 2.1358509063720703, 2.144136428833008, 2.1499228477478027, 2.1540470123291016, 2.1492269039154053, 2.1441752910614014, 2.134638786315918, 2.136739730834961, 2.1230297088623047, 2.109149217605591, 2.1046860218048096, 2.1003265380859375, 2.085144519805908, 2.074223279953003, 2.066187858581543, 2.056112051010132, 2.0417754650115967, 2.037087917327881, 2.0283091068267822, 2.0150649547576904, 2.000258445739746, 1.9921152591705322, 1.9744106531143188, 1.9654525518417358, 1.954437255859375, 1.9428000450134277, 1.9261436462402344, 1.9171143770217896, 1.9140522480010986, 1.9042999744415283, 1.8850293159484863, 1.8793892860412598, 1.8692011833190918, 1.859171748161316, 1.8457446098327637, 1.8362152576446533, 1.831392526626587, 1.8193511962890625, 1.806980848312378, 1.806101679801941, 1.7964414358139038, 1.7908635139465332, 1.7779438495635986, 1.7726483345031738, 1.764747142791748, 1.756056308746338, 1.7478394508361816, 1.7419404983520508, 1.732616662979126, 1.7288529872894287, 1.7279545068740845, 1.7195398807525635, 1.7099456787109375, 1.7136808633804321, 1.7060167789459229, 1.6969823837280273, 1.6949162483215332, 1.692852258682251, 1.6855382919311523, 1.6804730892181396, 1.6770415306091309, 1.6766258478164673, 1.6761162281036377, 1.672552227973938, 1.6629319190979004, 1.6659969091415405, 1.6612406969070435, 1.6605236530303955, 1.6580346822738647, 1.6543668508529663, 1.6549453735351562, 1.6527307033538818, 1.6439101696014404, 1.6428707838058472, 1.6452714204788208, 1.6439049243927002, 1.636620283126831, 1.63687264919281, 1.6330581903457642, 1.630275011062622, 1.6241943836212158, 1.6214922666549683, 1.6174169778823853, 1.610004186630249, 1.6001245975494385, 1.5976614952087402, 1.5941195487976074, 1.5871977806091309, 1.5772569179534912, 1.5697910785675049, 1.5614454746246338, 1.551461935043335, 1.5398439168930054, 1.5318961143493652, 1.519102692604065, 1.5117474794387817, 1.4991230964660645, 1.4849053621292114, 1.4740794897079468, 1.4659497737884521, 1.453723669052124, 1.4402424097061157, 1.4239249229431152, 1.4151721000671387, 1.4031044244766235, 1.3928157091140747, 1.379800796508789, 1.3682942390441895, 1.3631805181503296, 1.3555231094360352, 1.342212200164795, 1.3350253105163574, 1.3305249214172363, 1.3306610584259033, 1.3229098320007324, 1.3186655044555664, 1.319215178489685, 1.3192389011383057, 1.3176418542861938, 1.3168869018554688, 1.323311448097229, 1.3292877674102783, 1.3331258296966553, 1.3417787551879883, 1.3464759588241577, 1.3596137762069702, 1.3662841320037842, 1.3784514665603638, 1.394921064376831, 1.4103858470916748, 1.4228129386901855, 1.4383515119552612, 1.4565277099609375, 1.4764289855957031, 1.4967515468597412, 1.516669750213623, 1.5349936485290527, 1.5598375797271729, 1.580789566040039, 1.601300835609436, 1.6218500137329102, 1.6401358842849731, 1.6593494415283203, 1.681135892868042, 1.696661114692688, 1.7121673822402954, 1.7243638038635254, 1.7437570095062256, 1.7577836513519287, 1.7715823650360107, 1.7789584398269653, 1.7877416610717773, 1.8002862930297852, 1.8107786178588867, 1.819185733795166, 1.8323454856872559, 1.8419474363327026, 1.848493218421936, 1.8590577840805054, 1.8680301904678345, 1.8702025413513184, 1.8794498443603516, 1.8853495121002197, 1.893364429473877, 1.8965972661972046, 1.899944543838501, 1.9031002521514893, 1.9080784320831299, 1.9109441041946411, 1.9113426208496094, 1.9081871509552002, 1.910861611366272, 1.9091122150421143, 1.9098503589630127, 1.9054169654846191, 1.9079868793487549, 1.9055787324905396, 1.8974486589431763, 1.8971264362335205, 1.8959470987319946, 1.8905012607574463, 1.8901782035827637, 1.888779878616333, 1.8859139680862427, 1.8776710033416748, 1.8786239624023438, 1.8730659484863281, 1.8658636808395386, 1.8634743690490723, 1.8553334474563599, 1.8453938961029053, 1.8465522527694702, 1.8449242115020752, 1.8397514820098877, 1.8348169326782227, 1.829789161682129, 1.818169116973877, 1.8188124895095825, 1.8141300678253174, 1.810652494430542, 1.808395266532898, 1.8019081354141235, 1.7972506284713745, 1.7935072183609009, 1.7906689643859863, 1.7912800312042236, 1.7862417697906494, 1.7842061519622803, 1.7758066654205322, 1.776123046875, 1.778996467590332, 1.7771673202514648, 1.775059461593628, 1.7733936309814453, 1.7740062475204468, 1.7746773958206177, 1.772887110710144, 1.7773106098175049, 1.7788712978363037, 1.7794239521026611, 1.7782416343688965, 1.7823517322540283, 1.784118413925171, 1.7872034311294556, 1.7922935485839844, 1.7954142093658447, 1.7982006072998047, 1.8040978908538818, 1.8072601556777954, 1.8117246627807617, 1.8147165775299072, 1.8216161727905273, 1.825623631477356, 1.8294861316680908, 1.8323206901550293, 1.838452696800232, 1.8437917232513428, 1.846151351928711, 1.8450276851654053, 1.8512694835662842, 1.8559616804122925, 1.85966956615448, 1.8583629131317139, 1.860475778579712, 1.859307885169983, 1.8560261726379395, 1.8526322841644287, 1.8524503707885742, 1.8470311164855957, 1.84355628490448, 1.8375625610351562, 1.8294399976730347, 1.8221049308776855, 1.8162025213241577, 1.80690598487854, 1.8003500699996948, 1.7895920276641846, 1.7811152935028076, 1.770780086517334, 1.7577975988388062, 1.7454791069030762, 1.7303060293197632, 1.7174433469772339, 1.7074322700500488, 1.6924636363983154, 1.681823492050171, 1.6654127836227417, 1.6525027751922607, 1.6384811401367188, 1.622106909751892, 1.606553077697754, 1.5919227600097656]
}
'''
'''
results_powerspectrum = {
     'xs': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511],
     'Raw data' :[25141876.0, 13286992.0, 8955820.0, 4851923.0, 3892812.25, 3050182.5, 2347255.25, 1896700.75, 1525954.875, 1263125.75, 1058105.75, 891347.375, 766699.75, 666951.0, 591555.5625, 529092.9375, 478589.5, 435338.75, 397212.75, 363648.96875, 334474.125, 307504.21875, 283811.53125, 262763.21875, 244826.90625, 227678.6875, 212548.703125, 199033.40625, 187594.328125, 176524.640625, 166688.90625, 157329.78125, 149208.984375, 141788.109375, 134911.921875, 128553.3984375, 122273.7109375, 117257.953125, 112486.9140625, 107833.2578125, 103159.265625, 98889.3125, 94595.4140625, 90664.0859375, 86916.09375, 83536.5234375, 80415.8671875, 77514.640625, 74906.3125, 72001.8359375, 69438.34375, 66829.453125, 64475.94921875, 62029.390625, 59832.98046875, 57838.61328125, 55881.015625, 54059.33984375, 52325.421875, 50618.49609375, 49016.87109375, 47423.12109375, 45925.94140625, 44478.4140625, 43019.53515625, 41686.44140625, 40323.84375, 39139.21875, 37970.7109375, 36828.15625, 35812.4765625, 34841.03125, 33878.5234375, 32892.22265625, 31993.111328125, 31135.845703125, 30199.095703125, 29315.689453125, 28486.3984375, 27708.53515625, 26912.701171875, 26211.685546875, 25568.484375, 24915.564453125, 24270.333984375, 23651.17578125, 23058.09765625, 22437.87109375, 21875.1171875, 21311.974609375, 20782.193359375, 20252.873046875, 19743.4375, 19256.00390625, 18794.548828125, 18340.013671875, 17896.013671875, 17477.669921875, 17076.3984375, 16677.59765625, 16275.0419921875, 15891.75390625, 15531.921875, 15168.0439453125, 14816.1650390625, 14477.1640625, 14148.21484375, 13833.9150390625, 13522.8515625, 13243.140625, 12952.943359375, 12656.0732421875, 12385.1787109375, 12118.4638671875, 11857.0888671875, 11587.1103515625, 11344.759765625, 11107.5771484375, 10871.8876953125, 10635.3154296875, 10405.09375, 10197.33203125, 9975.1748046875, 9770.193359375, 9574.0751953125, 9373.71484375, 9187.4384765625, 8998.6875, 8820.7265625, 8642.431640625, 8467.70703125, 8309.181640625, 8141.38623046875, 7977.49365234375, 7818.611328125, 7665.3271484375, 7511.1474609375, 7362.58056640625, 7221.4130859375, 7088.78173828125, 6956.4443359375, 6825.03271484375, 6700.505859375, 6573.017578125, 6450.48291015625, 6328.498046875, 6206.0390625, 6094.7724609375, 5981.8076171875, 5871.62744140625, 5766.6162109375, 5659.26318359375, 5558.939453125, 5455.3271484375, 5355.41357421875, 5261.1259765625, 5167.3896484375, 5075.70849609375, 4988.44091796875, 4901.6611328125, 4816.58056640625, 4729.3994140625, 4646.001953125, 4565.93701171875, 4486.60009765625, 4409.6845703125, 4334.63232421875, 4262.66748046875, 4190.36083984375, 4120.4677734375, 4050.70361328125, 3980.265625, 3912.138671875, 3845.581298828125, 3779.189208984375, 3715.713623046875, 3655.260498046875, 3595.952880859375, 3538.279541015625, 3481.411865234375, 3425.979248046875, 3370.122314453125, 3313.984619140625, 3259.69482421875, 3206.369873046875, 3154.7890625, 3104.523681640625, 3055.9814453125, 3008.705810546875, 2962.079833984375, 2915.131591796875, 2869.6875, 2824.535888671875, 2778.665771484375, 2733.961181640625, 2691.293701171875, 2649.86474609375, 2609.45263671875, 2569.23388671875, 2531.54052734375, 2492.306396484375, 2454.446533203125, 2417.775390625, 2381.2353515625, 2346.611572265625, 2310.54345703125, 2277.16064453125, 2242.473876953125, 2208.437744140625, 2175.02880859375, 2142.0078125, 2109.7685546875, 2078.712646484375, 2047.566650390625, 2017.1783447265625, 1987.4345703125, 1958.0875244140625, 1930.089599609375, 1902.3743896484375, 1875.690673828125, 1849.054443359375, 1822.3514404296875, 1794.2344970703125, 1768.279296875, 1742.642578125, 1717.462158203125, 1692.822998046875, 1668.912353515625, 1646.3355712890625, 1623.7279052734375, 1600.619384765625, 1578.2537841796875, 1556.806884765625, 1534.783447265625, 1514.194091796875, 1493.203857421875, 1473.034423828125, 1453.0010986328125, 1432.9752197265625, 1414.0389404296875, 1394.798828125, 1375.8853759765625, 1356.8912353515625, 1338.320068359375, 1320.4765625, 1302.3670654296875, 1284.3868408203125, 1266.865966796875, 1250.555419921875, 1234.1126708984375, 1217.716796875, 1201.2408447265625, 1185.488037109375, 1169.4755859375, 1153.5521240234375, 1137.9691162109375, 1122.755859375, 1108.227783203125, 1093.362548828125, 1079.3084716796875, 1065.2711181640625, 1051.5191650390625, 1038.0482177734375, 1024.62939453125, 1011.54248046875, 998.5826416015625, 985.7373657226562, 973.33251953125, 960.98779296875, 948.6842651367188, 936.9301147460938, 925.10791015625, 913.5501098632812, 901.7206420898438, 890.2074584960938, 879.0147705078125, 867.3776245117188, 856.447021484375, 845.5843505859375, 835.097412109375, 824.7184448242188, 814.604248046875, 804.8720092773438, 794.9691772460938, 785.288818359375, 775.722412109375, 766.090087890625, 756.629638671875, 747.1991577148438, 738.093505859375, 729.378173828125, 720.3740844726562, 711.7059936523438, 702.715576171875, 694.3911743164062, 685.609375, 677.0723876953125, 668.9702758789062, 661.0812377929688, 653.4078369140625, 645.7487182617188, 638.44091796875, 630.90185546875, 623.3991088867188, 615.8792724609375, 608.6513671875, 601.4356689453125, 594.442626953125, 587.272216796875, 580.5233154296875, 573.7293090820312, 566.9773559570312, 560.4168701171875, 553.8124389648438, 547.5328369140625, 541.001708984375, 534.7037353515625, 528.7418823242188, 522.623779296875, 516.6343383789062, 510.79779052734375, 505.11456298828125, 499.5931091308594, 493.838134765625, 488.1368103027344, 482.5367126464844, 477.0275573730469, 471.5401916503906, 466.1739501953125, 460.876953125, 455.7603759765625, 450.8058166503906, 445.7428283691406, 440.95294189453125, 436.0252685546875, 431.24224853515625, 426.5335998535156, 421.7265930175781, 417.0493469238281, 412.28155517578125, 407.7283935546875, 403.2799072265625, 398.8334045410156, 394.5728759765625, 390.42376708984375, 386.2483215332031, 382.1973571777344, 378.0982666015625, 374.0193176269531, 369.95556640625, 366.00628662109375, 362.0304260253906, 358.15069580078125, 354.4022521972656, 350.563232421875, 346.8364562988281, 343.095947265625, 339.5651550292969, 335.9510498046875, 332.41156005859375, 329.0798645019531, 325.71551513671875, 322.4022521972656, 319.0783386230469, 315.8150939941406, 312.5162353515625, 309.1629638671875, 305.97344970703125, 302.8131103515625, 299.6266784667969, 296.5963439941406, 293.5699462890625, 290.66156005859375, 287.72503662109375, 284.82684326171875, 282.0689697265625, 279.2023620605469, 276.4267578125, 273.6347351074219, 270.9993896484375, 268.2995300292969, 265.6341857910156, 263.12451171875, 260.5594177246094, 258.14007568359375, 255.58432006835938, 253.18020629882812, 250.76470947265625, 248.32420349121094, 245.9781951904297, 243.6289520263672, 241.35421752929688, 239.12603759765625, 236.83966064453125, 234.6668243408203, 232.48683166503906, 230.33242797851562, 228.1403045654297, 226.03602600097656, 224.0401611328125, 221.9927520751953, 219.97579956054688, 218.04962158203125, 216.21824645996094, 214.32107543945312, 212.45217895507812, 210.67225646972656, 208.91578674316406, 207.0709686279297, 205.23745727539062, 203.53610229492188, 201.83346557617188, 200.0789031982422, 198.37493896484375, 196.71322631835938, 195.14669799804688, 193.5537872314453, 192.01156616210938, 190.51034545898438, 189.04600524902344, 187.65777587890625, 186.22862243652344, 184.8418731689453, 183.44471740722656, 182.13967895507812, 180.82957458496094, 179.55355834960938, 178.34368896484375, 177.09344482421875, 175.91812133789062, 174.7257080078125, 173.57394409179688, 172.47311401367188, 171.37098693847656, 170.2907257080078, 169.26490783691406, 168.30007934570312, 167.37013244628906, 166.39134216308594, 165.5266876220703, 164.70570373535156, 163.8613739013672, 163.08193969726562, 162.29449462890625, 161.552734375, 160.8280487060547, 160.19752502441406, 159.5591583251953, 158.96743774414062, 158.4168701171875, 157.97557067871094, 157.50906372070312, 157.06729125976562, 156.717041015625, 156.31704711914062, 156.00025939941406, 155.70001220703125, 155.55184936523438, 155.39122009277344, 155.25001525878906, 155.2377166748047, 155.30703735351562, 155.43060302734375, 155.5107879638672, 155.71400451660156, 156.0399169921875, 156.40650939941406, 156.82205200195312, 157.3544464111328, 157.99932861328125, 158.7686767578125, 159.61036682128906, 160.59054565429688, 161.67189025878906, 162.86753845214844, 164.1967010498047, 165.6467742919922, 167.3438720703125, 169.35015869140625, 171.19827270507812, 170.92869567871094, 166.2805938720703, 156.95675659179688, 145.14138793945312, 131.62783813476562, 117.17093658447266, 103.91419219970703, 94.19029998779297, 88.37032318115234, 84.25625610351562, 81.04232025146484, 78.44087982177734, 76.24996948242188, 74.35597229003906, 72.68389892578125, 71.15137481689453, 69.74664306640625, 68.44426727294922, 67.24844360351562, 66.10746002197266, 65.03433227539062, 64.03384399414062, 63.08150100708008, 62.179588317871094, 61.30385208129883, 60.47306823730469, 59.66187286376953, 58.893035888671875, 58.153297424316406, 57.452980041503906, 56.77273941040039, 56.099998474121094],
     'Ours' : [25086374.0, 13259168.0, 8937381.0, 4842663.0, 3885173.25, 3044032.0, 2342550.25, 1892818.625, 1522778.0, 1260462.625, 1055903.25, 889523.9375, 765123.625, 665592.6875, 590354.0625, 528018.5, 477596.375, 434427.5625, 396375.125, 362877.0, 333769.03125, 306860.1875, 283221.75, 262225.25, 244332.953125, 227216.96875, 212124.03125, 198633.875, 187228.3125, 176180.953125, 166365.25, 157027.890625, 148922.53125, 141518.578125, 134655.84375, 128305.8125, 122042.015625, 117035.9140625, 112280.5703125, 107639.8046875, 102974.2421875, 98719.1328125, 94437.6171875, 90519.3828125, 86774.4140625, 83404.03125, 80289.6328125, 77395.4921875, 74791.6640625, 71890.609375, 69333.796875, 66726.3046875, 64376.4609375, 61938.10546875, 59750.046875, 57760.75390625, 55806.99609375, 53990.32421875, 52257.95703125, 50550.44921875, 48947.95703125, 47358.5078125, 45864.76171875, 44419.671875, 42962.1171875, 41632.4375, 40274.40625, 39092.22265625, 37928.8125, 36785.4921875, 35773.8984375, 34801.140625, 33836.578125, 32848.4453125, 31947.669921875, 31093.68359375, 30159.134765625, 29277.740234375, 28450.388671875, 27675.751953125, 26881.939453125, 26182.416015625, 25539.0390625, 24889.9296875, 24246.859375, 23629.44921875, 23039.3828125, 22424.091796875, 21865.607421875, 21302.857421875, 20772.48828125, 20245.572265625, 19737.921875, 19250.611328125, 18788.515625, 18334.77734375, 17893.62890625, 17474.462890625, 17074.306640625, 16671.51171875, 16267.5830078125, 15884.5634765625, 15523.578125, 15161.1103515625, 14808.560546875, 14467.322265625, 14137.1337890625, 13820.8486328125, 13507.861328125, 13221.720703125, 12923.2060546875, 12623.49609375, 12347.96484375, 12075.1630859375, 11807.74609375, 11533.56640625, 11286.890625, 11043.265625, 10800.7578125, 10559.7890625, 10322.6728515625, 10106.7548828125, 9880.1884765625, 9670.41796875, 9469.931640625, 9263.955078125, 9071.1953125, 8876.318359375, 8691.021484375, 8506.337890625, 8322.4033203125, 8156.54150390625, 7983.7685546875, 7813.23193359375, 7647.44482421875, 7488.02490234375, 7328.13916015625, 7172.0400390625, 7025.375, 6889.3671875, 6752.07763671875, 6614.73291015625, 6483.64306640625, 6350.6962890625, 6221.7275390625, 6091.955078125, 5963.73779296875, 5847.77197265625, 5731.29443359375, 5616.068359375, 5505.533203125, 5396.95458984375, 5293.869140625, 5185.6181640625, 5083.86962890625, 4986.73681640625, 4890.8232421875, 4795.03857421875, 4704.6435546875, 4615.14453125, 4527.46630859375, 4439.59912109375, 4354.14208984375, 4271.55029296875, 4189.880859375, 4112.25439453125, 4037.536865234375, 3965.844970703125, 3894.762939453125, 3825.94677734375, 3757.956787109375, 3689.139892578125, 3621.111572265625, 3554.463623046875, 3488.527099609375, 3425.76611328125, 3366.484619140625, 3307.95703125, 3252.389404296875, 3196.420166015625, 3142.677001953125, 3090.153564453125, 3035.413330078125, 2983.51318359375, 2931.41162109375, 2883.7470703125, 2836.70849609375, 2789.6240234375, 2744.742431640625, 2701.097900390625, 2657.78955078125, 2615.054931640625, 2572.158935546875, 2530.02392578125, 2489.28173828125, 2450.86279296875, 2413.09375, 2376.168701171875, 2339.88037109375, 2305.100341796875, 2269.871826171875, 2234.5224609375, 2201.078125, 2167.69873046875, 2135.7890625, 2103.503173828125, 2074.215576171875, 2043.864013671875, 2013.9686279296875, 1984.635009765625, 1955.6505126953125, 1928.2210693359375, 1900.0267333984375, 1873.1285400390625, 1846.1243896484375, 1820.8114013671875, 1795.4609375, 1770.3046875, 1746.51904296875, 1722.0565185546875, 1698.4722900390625, 1673.7496337890625, 1650.047607421875, 1627.31982421875, 1604.8199462890625, 1583.19189453125, 1561.8165283203125, 1540.7784423828125, 1520.5291748046875, 1500.7432861328125, 1480.2606201171875, 1460.7928466796875, 1442.187744140625, 1422.9251708984375, 1404.593505859375, 1385.6163330078125, 1367.61083984375, 1350.0335693359375, 1331.9691162109375, 1315.490478515625, 1298.43212890625, 1281.9635009765625, 1264.8807373046875, 1248.07568359375, 1231.839111328125, 1215.2337646484375, 1198.8941650390625, 1182.765625, 1167.81787109375, 1152.43017578125, 1137.1143798828125, 1122.1849365234375, 1107.65185546875, 1093.179931640625, 1078.48681640625, 1063.94140625, 1050.2298583984375, 1036.8875732421875, 1023.0238647460938, 1009.609130859375, 996.4658813476562, 983.659912109375, 970.4968872070312, 957.3748168945312, 944.7362060546875, 932.2721557617188, 919.7241821289062, 907.2108764648438, 895.1275634765625, 882.994384765625, 871.3276977539062, 859.210693359375, 847.6813354492188, 836.18115234375, 824.74462890625, 813.4380493164062, 801.924072265625, 790.7955932617188, 779.5589599609375, 768.5333862304688, 757.6715698242188, 746.6666259765625, 736.0463256835938, 725.6542358398438, 715.046875, 704.7596435546875, 694.5159301757812, 684.4671020507812, 674.334228515625, 664.23876953125, 654.5004272460938, 644.4861450195312, 634.5929565429688, 624.852294921875, 615.2882080078125, 605.7454223632812, 596.10888671875, 586.5631103515625, 577.4290161132812, 568.2418823242188, 559.0137329101562, 549.8805541992188, 540.94482421875, 532.1825561523438, 523.365966796875, 514.7274169921875, 506.15985107421875, 497.63250732421875, 489.0686340332031, 480.68609619140625, 472.1288757324219, 463.7294616699219, 455.5837707519531, 447.5718078613281, 439.807861328125, 431.8489990234375, 424.14007568359375, 416.4290771484375, 408.8225402832031, 401.33099365234375, 393.7798156738281, 386.5447692871094, 379.3397216796875, 372.09832763671875, 364.9993896484375, 357.9806823730469, 351.0247497558594, 344.1992492675781, 337.55670166015625, 330.99798583984375, 324.3707580566406, 317.9281311035156, 311.79241943359375, 305.4871826171875, 299.449462890625, 293.56378173828125, 287.6938781738281, 281.85736083984375, 276.0900573730469, 270.5283203125, 264.85797119140625, 259.41693115234375, 254.1158447265625, 248.9314422607422, 243.806396484375, 238.77020263671875, 233.95010375976562, 229.12110900878906, 224.50619506835938, 219.8014373779297, 215.31898498535156, 210.8824462890625, 206.5464630126953, 202.2780303955078, 198.03419494628906, 193.99423217773438, 189.9760284423828, 186.06637573242188, 182.1781463623047, 178.35256958007812, 174.6624755859375, 171.06314086914062, 167.5377960205078, 164.0326690673828, 160.65093994140625, 157.3340606689453, 154.03118896484375, 150.77818298339844, 147.6309356689453, 144.58497619628906, 141.5930938720703, 138.62576293945312, 135.77548217773438, 133.04818725585938, 130.33331298828125, 127.6618881225586, 125.04879760742188, 122.54822540283203, 120.07101440429688, 117.66300964355469, 115.30770111083984, 113.00035858154297, 110.7917251586914, 108.61622619628906, 106.48108673095703, 104.38042449951172, 102.34392547607422, 100.36337280273438, 98.39898681640625, 96.5145034790039, 94.67707824707031, 92.89352416992188, 91.1530532836914, 89.44609832763672, 87.7967529296875, 86.19510650634766, 84.62256622314453, 83.10785675048828, 81.59303283691406, 80.17215728759766, 78.75909423828125, 77.35926818847656, 76.00105285644531, 74.67333984375, 73.42906951904297, 72.18960571289062, 70.99433135986328, 69.82556915283203, 68.71015930175781, 67.62393951416016, 66.54727172851562, 65.4766616821289, 64.46293640136719, 63.45573425292969, 62.49359893798828, 61.54044723510742, 60.64391326904297, 59.763179779052734, 58.89873504638672, 58.082725524902344, 57.272010803222656, 56.502044677734375, 55.733585357666016, 55.00220489501953, 54.294822692871094, 53.59550476074219, 52.9167594909668, 52.252777099609375, 51.61712646484375, 50.9974250793457, 50.386722564697266, 49.807403564453125, 49.25212860107422, 48.721946716308594, 48.19172286987305, 47.68341827392578, 47.20656204223633, 46.7345085144043, 46.280616760253906, 45.836936950683594, 45.40451431274414, 44.98884963989258, 44.57628631591797, 44.19237518310547, 43.79893493652344, 43.42437744140625, 43.07963562011719, 42.72689437866211, 42.38664627075195, 42.056575775146484, 41.73991012573242, 41.42827606201172, 41.126617431640625, 40.83439254760742, 40.559104919433594, 40.275238037109375, 40.00959396362305, 39.750423431396484, 39.48468780517578, 39.24017333984375, 38.99643325805664, 38.76231002807617, 38.52574920654297, 38.299686431884766, 38.089900970458984, 37.88383483886719, 37.680015563964844, 37.47666549682617, 37.28871154785156, 37.109962463378906, 36.92898178100586, 36.75177001953125, 36.57804489135742, 36.409141540527344, 36.245849609375, 36.08535385131836, 35.928245544433594, 35.776817321777344, 35.631954193115234, 35.504520416259766, 35.377323150634766, 35.24844741821289, 35.12152099609375, 35.00223159790039, 34.888038635253906, 34.76499938964844, 34.65043640136719, 34.53892135620117, 34.43434143066406, 34.332366943359375, 34.230281829833984, 34.14014434814453, 34.04792404174805, 33.959495544433594, 33.87434005737305, 33.789676666259766, 33.71051025390625, 33.62729263305664, 33.54425811767578, 33.46764373779297, 33.39337158203125, 33.31790542602539, 33.24443054199219, 33.17169952392578, 33.11022186279297, 33.04153823852539, 32.978519439697266, 32.921058654785156, 32.86847686767578, 32.816802978515625, 32.69873046875, 32.46784210205078],
     'SR-octree' : [25132244.0, 13281402.0, 8951631.0, 4848903.5, 3889900.0, 3047375.5, 2344633.25, 1894093.25, 1523378.875, 1260615.625, 1055676.375, 888950.0625, 764311.0625, 664528.375, 589094.4375, 526597.3125, 476018.78125, 432721.59375, 394539.53125, 360944.1875, 331732.9375, 304748.0, 281050.5625, 259982.1875, 242004.734375, 224838.3125, 209688.21875, 196144.625, 184676.703125, 173590.15625, 163750.40625, 154362.96875, 146224.90625, 138787.3125, 131887.625, 125493.71875, 119187.34375, 114149.9140625, 109352.46875, 104672.2578125, 99990.1796875, 95717.953125, 91428.515625, 87486.453125, 83732.8828125, 80343.078125, 77218.3515625, 74311.84375, 71680.3203125, 68771.578125, 66201.0625, 63602.31640625, 61242.62109375, 58804.3203125, 56615.2265625, 54627.60546875, 52678.9453125, 50852.0078125, 49125.234375, 47421.32421875, 45822.37109375, 44238.76953125, 42744.640625, 41310.5, 39861.3203125, 38543.33203125, 37201.390625, 36024.76171875, 34872.0859375, 33740.90625, 32732.736328125, 31760.68359375, 30803.291015625, 29830.77734375, 28940.876953125, 28095.048828125, 27180.693359375, 26321.798828125, 25511.099609375, 24756.1796875, 23985.947265625, 23299.900390625, 22669.26953125, 22036.30078125, 21407.46875, 20800.984375, 20222.861328125, 19628.716796875, 19086.10546875, 18539.935546875, 18029.962890625, 17522.8125, 17039.341796875, 16570.013671875, 16129.7783203125, 15695.2978515625, 15273.40625, 14875.9296875, 14490.0205078125, 14106.98046875, 13722.509765625, 13363.3212890625, 13021.7060546875, 12681.376953125, 12351.5205078125, 12031.814453125, 11723.306640625, 11424.521484375, 11135.63671875, 10871.1240234375, 10597.515625, 10327.3798828125, 10076.9404296875, 9833.5859375, 9593.8486328125, 9349.9873046875, 9130.8212890625, 8914.978515625, 8702.6982421875, 8491.1259765625, 8283.2216796875, 8091.80517578125, 7895.46435546875, 7714.65283203125, 7541.0703125, 7363.92138671875, 7200.4365234375, 7037.5224609375, 6880.341796875, 6722.6484375, 6568.48779296875, 6428.87158203125, 6284.10498046875, 6142.3505859375, 6007.1416015625, 5876.869140625, 5747.47509765625, 5622.4150390625, 5504.80810546875, 5396.02587890625, 5285.89453125, 5176.8916015625, 5074.97412109375, 4970.1201171875, 4869.62451171875, 4769.798828125, 4671.8642578125, 4584.2373046875, 4495.5712890625, 4410.138671875, 4327.9765625, 4247.85009765625, 4173.33984375, 4095.212890625, 4022.4755859375, 3952.232666015625, 3885.27392578125, 3817.199951171875, 3753.499267578125, 3690.28955078125, 3627.267822265625, 3566.835205078125, 3506.520751953125, 3450.7236328125, 3394.744873046875, 3343.28955078125, 3294.80078125, 3247.318359375, 3202.055419921875, 3156.745849609375, 3113.868408203125, 3069.783935546875, 3027.1875, 2984.815673828125, 2943.79931640625, 2904.882568359375, 2868.63818359375, 2831.937744140625, 2797.76611328125, 2764.260498046875, 2731.87060546875, 2701.999267578125, 2670.38330078125, 2641.94189453125, 2612.248046875, 2585.61474609375, 2559.0361328125, 2531.64501953125, 2506.032958984375, 2481.2392578125, 2456.72509765625, 2431.816650390625, 2407.468017578125, 2383.45263671875, 2358.60693359375, 2336.810791015625, 2313.908935546875, 2293.759521484375, 2271.09814453125, 2250.71875, 2231.080322265625, 2210.462890625, 2192.728515625, 2171.860595703125, 2154.205322265625, 2134.06884765625, 2115.39501953125, 2093.932861328125, 2073.0205078125, 2053.96728515625, 2033.6912841796875, 2015.5574951171875, 1996.7813720703125, 1978.93212890625, 1959.3017578125, 1940.0799560546875, 1920.5614013671875, 1901.5845947265625, 1881.5557861328125, 1860.809814453125, 1842.452392578125, 1822.9481201171875, 1802.7069091796875, 1780.9976806640625, 1760.1651611328125, 1739.3118896484375, 1717.093017578125, 1693.622802734375, 1671.4678955078125, 1648.776123046875, 1625.5469970703125, 1602.4229736328125, 1579.2845458984375, 1554.245849609375, 1530.4786376953125, 1505.9620361328125, 1480.3255615234375, 1455.20556640625, 1428.761962890625, 1403.357666015625, 1375.6943359375, 1347.50927734375, 1318.6904296875, 1288.283447265625, 1257.11376953125, 1226.1259765625, 1194.1226806640625, 1161.4693603515625, 1129.00390625, 1096.0333251953125, 1061.69970703125, 1026.0716552734375, 989.4236450195312, 950.93896484375, 912.0731811523438, 877.7230834960938, 850.851806640625, 830.9099731445312, 818.193359375, 814.0968017578125, 815.3104248046875, 818.0100708007812, 820.777099609375, 823.81787109375, 827.1791381835938, 829.7216796875, 832.7659912109375, 835.8765869140625, 839.984619140625, 842.9035034179688, 845.9434204101562, 848.7767944335938, 851.534912109375, 853.7897338867188, 854.3933715820312, 855.5598754882812, 856.0223388671875, 856.4060668945312, 856.35888671875, 855.9899291992188, 856.0278930664062, 855.8786010742188, 855.4097900390625, 854.5775756835938, 853.4462280273438, 851.8607177734375, 850.1112670898438, 847.6365356445312, 845.0194702148438, 842.2386474609375, 839.36767578125, 836.6060791015625, 832.9148559570312, 829.8011474609375, 826.0823364257812, 821.9711303710938, 817.8948974609375, 813.704833984375, 809.6802368164062, 805.043212890625, 800.3983764648438, 795.8177490234375, 790.9659423828125, 786.127685546875, 781.2378540039062, 776.3318481445312, 771.692626953125, 766.4392700195312, 761.2966918945312, 755.89306640625, 750.4918212890625, 745.7673950195312, 740.2044677734375, 735.2103881835938, 730.607177734375, 725.4835815429688, 720.821044921875, 715.47900390625, 710.2374267578125, 705.7545776367188, 700.5547485351562, 696.4874877929688, 691.8468627929688, 687.1177368164062, 683.3565673828125, 678.978271484375, 674.8321533203125, 670.4938354492188, 666.6170654296875, 663.0614013671875, 659.1465454101562, 655.7939453125, 652.7390747070312, 649.8187866210938, 646.8560180664062, 644.2083740234375, 641.6151123046875, 639.03662109375, 636.3818969726562, 633.7366333007812, 631.6297607421875, 629.4259643554688, 627.7952880859375, 626.0906372070312, 624.6311645507812, 623.42529296875, 622.0878295898438, 621.150390625, 620.0771484375, 619.2242431640625, 618.574951171875, 617.9061279296875, 617.3737182617188, 616.7476806640625, 616.2654418945312, 615.666015625, 615.3160400390625, 615.193359375, 614.7626342773438, 614.69970703125, 614.4883422851562, 614.3919677734375, 614.0614013671875, 613.3917236328125, 612.900390625, 611.992919921875, 611.1935424804688, 610.001953125, 609.1231689453125, 608.251708984375, 607.2630004882812, 606.2374877929688, 605.2764892578125, 604.6358642578125, 603.6674194335938, 602.890380859375, 602.3126220703125, 601.82275390625, 601.0425415039062, 600.3038330078125, 599.8391723632812, 599.4749145507812, 599.2013549804688, 598.7662963867188, 598.8283081054688, 598.6171264648438, 598.7136840820312, 598.5442504882812, 598.0870361328125, 597.9546508789062, 597.5980834960938, 597.6692504882812, 597.2802124023438, 597.1073608398438, 597.4594116210938, 597.7301025390625, 598.1304321289062, 598.1954345703125, 598.3310546875, 598.4630126953125, 598.682373046875, 598.9364624023438, 599.0576171875, 599.7174682617188, 600.5422973632812, 600.8466796875, 601.312255859375, 601.9002685546875, 602.3974609375, 602.8402709960938, 602.9353637695312, 603.8067016601562, 604.2817993164062, 604.6519165039062, 605.2142944335938, 605.6998291015625, 606.3735961914062, 606.9798583984375, 607.5481567382812, 608.26318359375, 608.8380737304688, 609.190185546875, 609.953857421875, 610.4891967773438, 611.072265625, 611.5262451171875, 612.291015625, 612.6510620117188, 612.80908203125, 612.9273071289062, 612.9762573242188, 612.8861694335938, 612.9046630859375, 613.596923828125, 613.6477661132812, 613.8983764648438, 614.1630859375, 614.3814697265625, 614.7525024414062, 614.6544799804688, 614.6533813476562, 614.6949462890625, 614.7125244140625, 614.7023315429688, 614.3853759765625, 614.0360107421875, 613.8653564453125, 613.1323852539062, 612.5751342773438, 612.0900268554688, 611.28125, 610.6011352539062, 609.698974609375, 608.8304443359375, 607.5247802734375, 606.4237060546875, 605.121337890625, 603.8177490234375, 602.3216552734375, 600.9725341796875, 599.6211547851562, 597.8339233398438, 596.1483154296875, 594.11962890625, 592.159423828125, 590.2316284179688, 587.9564819335938, 585.444091796875, 582.9096069335938, 580.3082885742188, 577.7213745117188, 574.3182983398438, 570.9820556640625, 567.882080078125, 564.2346801757812, 560.601806640625, 556.4447631835938, 552.6826782226562, 548.4627075195312, 543.9164428710938, 539.3906860351562, 534.3480834960938, 529.59521484375, 524.3068237304688, 519.0333251953125, 513.223876953125, 506.9593505859375, 500.6521301269531, 494.1068420410156, 487.329345703125, 480.4949035644531, 473.3659362792969, 466.2189636230469, 458.52825927734375, 450.35748291015625, 441.810546875, 432.9241943359375, 423.8951721191406, 414.4730224609375, 404.65191650390625, 394.53326416015625, 383.9576721191406, 372.8827819824219, 361.3356018066406, 349.3583984375, 336.9060974121094, 323.8538513183594, 310.1408386230469, 295.6970520019531, 280.0346984863281, 263.290283203125, 247.6102294921875],
     'SZ' : [25140042.0, 13286912.0, 8956124.0, 4852523.0, 3893000.0, 3050219.0, 2347155.75, 1896422.25, 1525565.375, 1262613.625, 1057567.75, 890780.125, 766139.0, 666395.5625, 590983.3125, 528536.375, 478005.6875, 434750.625, 396585.65625, 362984.28125, 333786.28125, 306795.5, 283104.6875, 262026.8125, 244060.625, 226894.46875, 211748.53125, 198202.3125, 186728.234375, 175627.453125, 165766.46875, 156399.390625, 148249.8125, 140812.6875, 133905.171875, 127526.09375, 121223.5390625, 116171.875, 111357.375, 106673.84375, 101971.7578125, 97672.765625, 93347.5, 89387.2734375, 85619.03125, 82202.578125, 79052.71875, 76116.0546875, 73472.875, 70546.171875, 67954.09375, 65320.1328125, 62936.2421875, 60465.26953125, 58244.21875, 56215.51953125, 54229.96484375, 52376.75390625, 50612.83984375, 48878.57421875, 47247.171875, 45628.64453125, 44105.515625, 42632.35546875, 41153.09765625, 39797.96875, 38408.25390625, 37198.73828125, 36010.72265625, 34848.60546875, 33810.24609375, 32809.77734375, 31826.859375, 30824.44921875, 29898.32421875, 29020.431640625, 28065.26171875, 27170.822265625, 26328.265625, 25533.955078125, 24729.111328125, 24009.876953125, 23353.111328125, 22680.88671875, 22022.736328125, 21383.53125, 20777.3125, 20148.2421875, 19575.09765625, 19006.8359375, 18470.498046875, 17941.900390625, 17430.849609375, 16939.578125, 16467.470703125, 16009.341796875, 15559.2939453125, 15137.4365234375, 14728.4052734375, 14327.4375, 13930.9677734375, 13550.0498046875, 13193.0849609375, 12834.2021484375, 12489.310546875, 12155.6298828125, 11834.2138671875, 11525.1181640625, 11220.875, 10943.6748046875, 10662.91796875, 10378.0224609375, 10114.8857421875, 9856.4765625, 9606.1884765625, 9352.0341796875, 9118.373046875, 8894.2119140625, 8672.5849609375, 8455.7021484375, 8243.958984375, 8052.16162109375, 7852.7783203125, 7667.26904296875, 7489.75732421875, 7311.4853515625, 7144.90478515625, 6978.806640625, 6822.53857421875, 6665.439453125, 6513.84912109375, 6376.3486328125, 6235.0595703125, 6095.16064453125, 5962.1494140625, 5836.36669921875, 5709.18115234375, 5586.2724609375, 5473.818359375, 5369.4814453125, 5263.53173828125, 5157.97998046875, 5062.037109375, 4964.03955078125, 4866.73583984375, 4772.02490234375, 4678.68603515625, 4594.560546875, 4510.03564453125, 4427.63623046875, 4350.654296875, 4271.654296875, 4199.3017578125, 4123.06396484375, 4050.28076171875, 3984.61181640625, 3916.016357421875, 3851.46826171875, 3790.540771484375, 3729.816650390625, 3669.4658203125, 3606.742919921875, 3549.422119140625, 3491.42919921875, 3433.53955078125, 3379.34765625, 3326.68212890625, 3277.40185546875, 3227.268798828125, 3180.39306640625, 3131.591064453125, 3084.559814453125, 3038.613037109375, 2991.469970703125, 2946.02978515625, 2902.512939453125, 2861.303466796875, 2821.4873046875, 2783.010498046875, 2747.431884765625, 2712.817626953125, 2677.81005859375, 2645.70654296875, 2612.67138671875, 2583.577392578125, 2552.575439453125, 2523.707275390625, 2496.275634765625, 2470.456298828125, 2447.026123046875, 2420.758544921875, 2399.16259765625, 2377.2412109375, 2355.558349609375, 2335.3779296875, 2315.52783203125, 2298.0341796875, 2279.113525390625, 2262.22998046875, 2246.837890625, 2230.16064453125, 2215.310791015625, 2200.21875, 2185.416259765625, 2170.30859375, 2155.8837890625, 2142.55908203125, 2128.677734375, 2116.7421875, 2104.771484375, 2094.0546875, 2082.614501953125, 2070.75, 2059.3076171875, 2046.712890625, 2036.5228271484375, 2024.990234375, 2015.2982177734375, 2005.3648681640625, 1995.4364013671875, 1985.745361328125, 1975.5531005859375, 1964.674560546875, 1953.6842041015625, 1944.018310546875, 1933.4049072265625, 1923.262451171875, 1913.514892578125, 1904.1666259765625, 1894.1085205078125, 1883.1842041015625, 1872.7230224609375, 1863.2755126953125, 1852.108642578125, 1841.407958984375, 1830.5950927734375, 1820.1683349609375, 1808.6009521484375, 1795.8079833984375, 1783.733154296875, 1770.9658203125, 1757.185791015625, 1743.0224609375, 1729.4954833984375, 1715.373046875, 1699.881591796875, 1684.73486328125, 1669.5843505859375, 1653.6278076171875, 1637.039794921875, 1620.498046875, 1604.31396484375, 1588.1661376953125, 1572.4183349609375, 1557.7603759765625, 1543.1405029296875, 1528.9083251953125, 1514.121826171875, 1498.9931640625, 1484.047119140625, 1468.71337890625, 1453.3782958984375, 1438.87939453125, 1425.650634765625, 1412.1048583984375, 1399.462646484375, 1387.0877685546875, 1374.842041015625, 1363.2413330078125, 1350.42041015625, 1339.0184326171875, 1326.730712890625, 1314.91796875, 1303.4271240234375, 1291.5242919921875, 1280.949951171875, 1269.4776611328125, 1259.0809326171875, 1248.303955078125, 1238.0615234375, 1227.9815673828125, 1217.5364990234375, 1207.5390625, 1197.33203125, 1187.800537109375, 1178.13330078125, 1168.038330078125, 1158.6199951171875, 1149.876953125, 1140.857421875, 1132.2454833984375, 1123.378662109375, 1114.7076416015625, 1106.116455078125, 1097.3651123046875, 1089.2049560546875, 1081.0947265625, 1072.9744873046875, 1065.365234375, 1057.7127685546875, 1050.0205078125, 1042.334228515625, 1034.7769775390625, 1027.7977294921875, 1021.0133666992188, 1014.3549194335938, 1007.9764404296875, 1001.3951416015625, 994.8221435546875, 988.298583984375, 982.1041259765625, 975.85546875, 969.9302368164062, 964.248779296875, 958.7221069335938, 953.208984375, 947.3475341796875, 941.79736328125, 936.5003662109375, 931.0283203125, 925.47705078125, 920.4869995117188, 915.7028198242188, 910.82763671875, 905.5574340820312, 900.7262573242188, 895.9791259765625, 890.5762329101562, 885.690185546875, 880.7027587890625, 875.8668823242188, 870.8870239257812, 866.111572265625, 861.6068115234375, 856.7537231445312, 851.8948974609375, 847.0258178710938, 842.700927734375, 837.9742431640625, 833.6423950195312, 829.2338256835938, 825.2230834960938, 821.3671264648438, 817.3464965820312, 813.3553466796875, 809.4246826171875, 805.8170166015625, 801.78076171875, 797.7027587890625, 793.72216796875, 790.3976440429688, 786.8432006835938, 783.23095703125, 780.1178588867188, 777.2537841796875, 774.6553955078125, 771.734619140625, 769.3119506835938, 767.2828979492188, 765.045654296875, 762.9378051757812, 760.9224853515625, 758.83935546875, 757.1056518554688, 755.05322265625, 753.4863891601562, 752.1709594726562, 750.9159545898438, 750.089111328125, 748.9017333984375, 748.0357666015625, 747.5089111328125, 746.8538818359375, 746.1165161132812, 745.4715576171875, 744.9641723632812, 744.5673217773438, 743.9049072265625, 743.268798828125, 742.7949829101562, 742.3162841796875, 741.8408813476562, 741.076416015625, 740.113037109375, 739.5142211914062, 738.7108154296875, 737.664794921875, 736.6333618164062, 735.7399291992188, 734.6648559570312, 733.427978515625, 732.364990234375, 731.1055908203125, 729.7080688476562, 728.3575439453125, 727.30615234375, 726.0611572265625, 724.6103515625, 723.4706420898438, 722.3829956054688, 721.2230224609375, 719.8196411132812, 718.3875732421875, 716.820556640625, 715.3382568359375, 713.7517700195312, 712.394775390625, 710.7255249023438, 709.1192626953125, 707.6550903320312, 706.1121215820312, 704.6255493164062, 702.6729736328125, 701.2367553710938, 699.6781616210938, 698.0101318359375, 696.1544799804688, 694.4179077148438, 692.7006225585938, 690.8418579101562, 689.0565795898438, 687.46875, 685.9212646484375, 684.2257690429688, 682.6304321289062, 680.8450927734375, 679.3353881835938, 677.6156005859375, 675.8213500976562, 674.0729370117188, 672.4496459960938, 670.9967651367188, 669.0643920898438, 667.4789428710938, 665.774658203125, 664.129638671875, 662.5123901367188, 660.8478393554688, 659.385986328125, 657.8442993164062, 656.4347534179688, 654.9685668945312, 653.5841064453125, 652.05810546875, 650.5470581054688, 649.0493774414062, 647.568115234375, 646.0777587890625, 644.5557861328125, 643.2374877929688, 641.9409790039062, 640.453125, 639.1685180664062, 637.9728393554688, 636.580322265625, 635.3001708984375, 634.0682373046875, 632.79638671875, 631.6026611328125, 630.2958374023438, 629.013671875, 627.8966064453125, 626.5953979492188, 625.5006103515625, 624.3063354492188, 623.3893432617188, 622.3204956054688, 621.2110595703125, 620.1679077148438, 619.1118774414062, 618.04541015625, 616.84326171875, 615.9456787109375, 614.9801635742188, 613.9580078125, 612.8753051757812, 611.7736206054688, 610.8096923828125, 609.7308349609375, 608.4657592773438, 607.2495727539062, 606.0509643554688, 604.784423828125, 603.2223510742188, 601.7694702148438, 600.5296020507812, 599.2265625, 597.947509765625, 596.8887939453125, 595.603271484375, 594.39306640625, 593.1397094726562, 591.9876708984375, 590.8253173828125, 589.5977172851562, 588.550048828125, 587.3819580078125, 586.1613159179688, 584.9620971679688, 583.6386108398438, 582.28466796875, 581.0192260742188, 579.824462890625, 578.66357421875, 577.47900390625, 576.4356689453125, 575.3408813476562, 574.2741088867188, 573.1587524414062, 571.9419555664062, 570.5778198242188, 568.8909301757812]
}
font = {#'font.family' : 'normal',
        #'font.weight' : 'bold',
        'font.size'   : 18}
plt.rcParams.update(font)
xs = results_powerspectrum['xs']
GT_freqs = results_powerspectrum['Raw data']
NN_freqs = results_powerspectrum['Ours']
SZ_freqs = results_powerspectrum['SZ']
octree_freqs = results_powerspectrum['SR-octree']

plt.plot(xs, np.array(GT_freqs), label="Raw data", color="red")
plt.plot(xs, np.array(NN_freqs), label="Ours", color="blue")
plt.plot(xs, np.array(octree_freqs), label="SR-octree", color="gray")
plt.plot(xs, np.array(SZ_freqs), label="SZ", color="green")

#plt.legend()
plt.xlabel("Wavenumber")
plt.title("Iso3D magnitude")
plt.ylabel("Power")
plt.yscale("log")
plt.xscale("log")
#plt.xscale("log")
#plt.xticks(xs, xs_labels)
#plt.title(d)
#plt.savefig(os.path.join(save_folder, metric+"_psnr.png"))
plt.tight_layout()
plt.show()
plt.savefig("powerspectra.png")

plt.clf()
xs = np.array(xs)
spot = (xs >= 60) & (xs <= 300)
plt.plot(xs[spot], np.array(GT_freqs)[spot], label="Raw data", color="red")
plt.plot(xs[spot], np.array(NN_freqs)[spot], label="Ours", color="blue")
plt.plot(xs[spot], np.array(octree_freqs)[spot], label="SR-octree", color="gray")
plt.plot(xs[spot], np.array(SZ_freqs)[spot], label="SZ", color="green")

#plt.title("Iso3D magnitude")
#plt.ylabel("Power")
#plt.xlabel("Wavenumber")
#plt.legend()
plt.yscale("log")
plt.xscale("log")
plt.show()
plt.savefig("powerspectra_zoom.png")
'''


'''
results_psnr = {
     "Iso2D magnitude": {
          "NN": [48.04, 39.64, 32.28, 27.57, 24.64, 22.42],
          "Bilinear interpolation": [41.79, 33.97, 28.89, 25.52, 23.16, 21.30],
          "Bicubic interpolation": [43.52, 34.87, 29.31, 25.75, 23.31, 21.47]
     },
     "Iso3D magnitude": {
          "NN": [52.55, 41.83, 34.44, 29.83],
          "Trilinear interpolation": [43.11, 35.58, 30.77, 27.62]
     },
     "Mixing3D pressure": {
          #"NN_old": [51.52, 45.99, 39.68, 36.90, 31.59],
          "NN":[53.38, 46.536, 40.001, 34.998, 31.59],
          "Trilinear interpolation": [51.00, 42.37, 36.75, 33.14, 30.72]
     },
     "Mixing2D magnitude": {
          "NN":[45.43, 39.12, 32.86, 26.67, 22.50, 19.63],
          "Bilinear interp.": [44.08, 34.91, 28.48, 23.88, 20.90, 18.96],
          "Bicubic interp.": [45.36, 35.83, 29.13, 24.29, 21.14, 19.09]
     }
}
results_inner_psnr = {
     "Mixing2D magnitude": {
          "NN":[57.11, 45.16, 33.93, 26.83, 22.63, 19.71],
          "Bilinear interp.": [43.92, 34.77, 28.36, 23.86, 20.90, 18.98],
          "Bicubic interp.": [45.25, 35.71, 29.01, 24.25, 21.15, 19.12]
     }
}
results_ssim = {
     "Iso2D magnitude": {
          "NN": [0.990, 0.926, 0.704, 0.474, 0.355, 0.310],
          "Bilinear interpolation": [0.978, 0.820, 0.575, 0.401, 0.326, 0.299],
          "Bicubic interpolation": [0.980, 0.854, 0.607, 0.416, 0.332, 0.302]
     },
     "Iso3D magnitude": {
          "NN": [0.995, 0.930, 0.692, 0.432],
          "Trilinear interpolation": [0.961, 0.791, 0.519, 0.330]
     },
     "Mixing3D pressure": {
          #"NN_old": [0.999, 0.999, 0.996, 0.984, 0.962],
          "NN":[0.9997, 0.9992, 0.9953, 0.9829, 0.962],
          "Trilinear interpolation": [0.999, 0.997, 0.990, 0.974, 0.953]
     },
     "Mixing2D magnitude": {
          "NN":[0.997, 0.975, 0.834, 0.576, 0.372, 0.239],
          "Bilinear interp.": [0.978, 0.879, 0.669, 0.448, 0.298, 0.194],
          "Bicubic interp.": [0.983, 0.900, 0.700, 0.471, 0.314, 0.207]
     }
}
font = {#'font.family' : 'normal',
        #'font.weight' : 'bold',
        'font.size'   : 18}
plt.rcParams.update(font)
fig, ax1 = plt.subplots()

d = "Mixing2D magnitude"
markers = {
     "NN" : "^",
     "Bilinear interpolation": "s",
     "Trilinear interpolation": "s",
     "Bicubic interpolation": "o",
     "Bilinear interp.": "s",     
     "Bicubic interp.": "o"
}
colors = {
     "NN" : "blue",
     "Bilinear interpolation": "green",
     "Trilinear interpolation": "orange",
     "Bicubic interpolation": "red",
     "Bilinear interp.": "green",     
     "Bicubic interp.": "red"
}
for method in results_inner_psnr[d].keys():
     xs = []
     for i in range(len(results_inner_psnr[d][method])):
          xs.append(int(2**(i+1)))
     ax1.plot(xs, results_inner_psnr[d][method], label=method, 
     marker=markers[method], color = colors[method])

ax2 = ax1.twinx()
for method in results_ssim[d].keys():
     xs = []
     for i in range(len(results_ssim[d][method])):
          xs.append(int(2**(i+1)))
     ax2.plot(xs, results_ssim[d][method], label=method, marker=markers[method], 
     color = colors[method], linestyle="--")

xs_labels = []
for i in range(len(xs)):
     xs_labels.append(str(xs[i]))
print(xs)
#plt.legend()
ax1.set_ylabel("Inner PSNR (dB)")
ax2.set_ylabel("SSIM")
ax2.set_ylim(0.15)
#plt.ylabel("PSNR (dB)")
plt.xscale("log")
plt.xticks(xs, xs_labels)
plt.xlabel("SR scale factor")
ax1.set_xlabel("SR scale factor")
plt.title(d)
fig.tight_layout()
#plt.savefig(os.path.join(save_folder, metric+"_psnr.png"))
plt.show()
'''


'''
files_to_convert = [
     "isomag2D_compressiontest"
]

file_loc_base = os.path.join(FlowSTSR_folder_path, "TestingData", "octree_files")
f = h5py.File(os.path.join(file_loc_base, files_to_convert[0]+".h5"), 'r')
d = np.array(f['data'])
#d[0].tofile("512cubed.dat")


rootgrp = Dataset(files_to_convert[0]+".nc", "w", format="NETCDF4")
rootgrp.createDimension("u")
rootgrp.createDimension("v")
#rootgrp.createDimension("w")
rootgrp.createDimension("channels", d.shape[0])
dim_0 = rootgrp.createVariable("velocity magnitude", np.float32, ("u","v"))
dim_0[:] = d[0]
#dim_1 = rootgrp.createVariable("v", np.float32, ("u","v", "w"))
#dim_1[:] = d[1]
#dim_2 = rootgrp.createVariable("w", np.float32, ("u","v", "w"))
#dim_2[:] = d[2]
'''
'''
def to_netcdf(vf, name):
     rootgrp = Dataset(name+".nc", "w", format="NETCDF4")

     if(len(vf.shape) == 3):
          rootgrp.createDimension("u")
          rootgrp.createDimension("v")
          rootgrp.createDimension("channels", vf.shape[0])
          for i in range(vf.shape[0]):
               dim_i = rootgrp.createVariable("dim"+str(i), np.float32, ("u","v"))
               dim_i[:] = vf[i]
     if(len(vf.shape) == 4):
          rootgrp.createDimension("u")
          rootgrp.createDimension("v")
          rootgrp.createDimension("w")
          rootgrp.createDimension("channels", vf.shape[0])     
          for i in range(vf.shape[0]):
               dim_i = rootgrp.createVariable("dim"+str(i), np.float32, ("u","v", "w"))
               dim_i[:] = vf[i]

files_to_convert = [
     "isomag2D_compressiontest",
     "isomag3D_compressiontest",
     "mixing3D_compressiontest",
     "iso3DVF_compressiontest"
]
file_loc_base = os.path.join(FlowSTSR_folder_path, "TestingData", "octree_files")
for name in files_to_convert:
     print("Loading " + name)
     f = h5py.File(os.path.join(file_loc_base, name+".h5"), 'r')
     d = np.array(f['data'])
     to_netcdf(d, name)
     print("Finished " + name)
'''

'''
VF_folder = os.path.join(FlowSTSR_folder_path, "TestingData", "iso1024")
new_VF_folder = os.path.join(FlowSTSR_folder_path, "TestingData", "iso3DVF")
#mixing_folder = os.path.join(FlowSTSR_folder_path, "InputData", "mixing_p")
#new_mixing_folder = os.path.join(FlowSTSR_folder_path, "InputData", "mix_p")

for filename in os.listdir(VF_folder):
     file_loc = os.path.join(VF_folder, filename)
     f = h5py.File(file_loc, 'r+')
     d = np.array(f.get('data'))
     f.close()

     octant_no = 0
     for x in range(0, d.shape[0], int(d.shape[0]/2)):
          x_end = x+int(d.shape[0]/2)
          for y in range(0, d.shape[1], int(d.shape[1]/2)):
               y_end = y+int(d.shape[1]/2)
               for z in range(0, d.shape[2], int(d.shape[2]/2)):
                    z_end = z+int(d.shape[2]/2)
                    print("Saving octant " + str(octant_no))
                    f_h5 = h5py.File(os.path.join(new_VF_folder, "vf_ts"+filename+\
                         "_octant"+str(octant_no)+'.h5'), 'w')
                    a = d[x:x_end, y:y_end, z:z_end,:]
                    a = np.transpose(a, (3, 0, 1, 2))
                    f_h5.create_dataset("data", data=a)
                    f_h5.close()
                    octant_no += 1
'''
'''
for filename in os.listdir(mixing_folder):
     file_loc = os.path.join(mixing_folder, filename)
     f = h5py.File(file_loc, 'r+')
     d = np.expand_dims(f.get('data')[:,:,:,0], axis=0).astype(np.float32)
     f.close()

     file_loc = os.path.join(new_mixing_folder, filename)
     f = h5py.File(file_loc, 'w')
     f.create_dataset("data", data=d)
     f.close()
'''



'''
# This simply converts a vector field from some .h5 files
# to their magnitude fields, and also splits it into octants before
# saving.

FlowSTSR_folder_path = os.path.dirname(os.path.abspath(__file__))
location = os.path.join(FlowSTSR_folder_path, "InputData", "iso1024_VF")
save_location = os.path.join(FlowSTSR_folder_path, "InputData", "iso1024_magfield")

for filename in os.listdir(location):
     print("Loading " + filename)
     f = h5py.File(os.path.join(location, filename), 'r')
     fname = filename.split(".")[0]
     data =  np.array(f['data'])
     print("Loaded velocity field " + str(data.shape))
     mag_field = np.linalg.norm(data, axis=0)
     print("Converted to velocity magnitude " + str(mag_field.shape))
     octant_no = 0
     for x_start, x_end in [(0, int(mag_field.shape[0]/2)), (int(mag_field.shape[0]/2), mag_field.shape[0])]:
          for y_start, y_end in [(0, int(mag_field.shape[1]/2)), (int(mag_field.shape[1]/2), mag_field.shape[1])]:
               for z_start, z_end in [(0, int(mag_field.shape[2]/2)), (int(mag_field.shape[2]/2), mag_field.shape[2])]:
                    print("Saving octant " + str(octant_no))
                    f_h5 = h5py.File(os.path.join(save_location, "v_mag_ts"+fname+"_octant"+str(octant_no)+'.h5'), 'w')
                    f_h5.create_dataset("data", data=mag_field[x_start:x_end, y_start:y_end, z_start:z_end])
                    f_h5.close()
                    octant_no += 1

'''
'''
# Experiment to see if the distribution of downscaled frames that are
# downscaled with a method that doesn't follow downscale(x, S) = 
# downscale(downscale(x, S/2), S/2).
# Compare distributions with PCA? T-SNE? Just mean and variance?
#
from download_JHUTDB import get_full_frame_parallel


frames = []
name = "isotropic1024"
startts = 1
endts = 1001
ts_skip = 10
ds = 32

ds_once_data = []
ds_many_data = []

ds_once_stats = []
ds_many_stats = []

for i in range(startts, endts, ts_skip):
     print("TS " + str(i))
     f = get_full_frame_parallel(0, 1024, 1,#x
     0, 1024, 1, #y
     512, 513, 1, #z
     name, i, 
     "u", 3, 
     64)
     f = f[:,:,0,:].astype(np.float32)

     f_img = f.copy()
     f_img[:,:,0] -= f_img[:,:,0].min()
     f_img[:,:,0] *= (255.0/f_img[:,:,0].max())
     f_img[:,:,1] -= f_img[:,:,1].min()
     f_img[:,:,1] *= (255.0/f_img[:,:,1].max())
     f_img[:,:,2] -= f_img[:,:,2].min()
     f_img[:,:,2] *= (255.0/f_img[:,:,2].max())
     f_img = f_img.astype(np.uint8)
     imageio.imwrite("full_res.png", f_img)

     f = f.swapaxes(0,2).swapaxes(1,2)
     f = torch.from_numpy(f).unsqueeze(0)
     f_downscaled_once = F.interpolate(f.clone(), mode="bilinear", align_corners=True, scale_factor=1/ds)
     f_downscaled_many = f.clone()
     curr_s = 1
     while(curr_s < ds):
          f_downscaled_many = F.interpolate(f_downscaled_many, mode="bilinear", align_corners=True, scale_factor=1/2)
          curr_s *= 2
     
     ds_once_data.append(f_downscaled_once.clone().view(1, -1).cpu().numpy())
     ds_many_data.append(f_downscaled_many.clone().view(1, -1).cpu().numpy())
     ds_once_stats.append(np.array([f_downscaled_once.min(), f_downscaled_once.max(), f_downscaled_once.mean(), f_downscaled_once.std()]))
     ds_many_stats.append(np.array([f_downscaled_many.min(), f_downscaled_many.max(), f_downscaled_many.mean(), f_downscaled_many.std()]))

     print("DS_once min/max: %0.03f/%0.03f, mean/std: %0.03f/%0.03f" % \
          (f_downscaled_once.min(), f_downscaled_once.max(), f_downscaled_once.mean(), f_downscaled_once.std()))
     print("DS_many min/max: %0.03f/%0.03f, mean/std: %0.03f/%0.03f" % \
          (f_downscaled_many.min(), f_downscaled_many.max(), f_downscaled_many.mean(), f_downscaled_many.std()))

     ds_once_img = f_downscaled_once[0].permute(1, 2, 0).cpu().numpy()
     ds_once_img[:,:,0] -= ds_once_img[:,:,0].min()
     ds_once_img[:,:,0] *= (255.0/ds_once_img[:,:,0].max())
     ds_once_img[:,:,1] -= ds_once_img[:,:,1].min()
     ds_once_img[:,:,1] *= (255.0/ds_once_img[:,:,1].max())
     ds_once_img[:,:,2] -= ds_once_img[:,:,2].min()
     ds_once_img[:,:,2] *= (255.0/ds_once_img[:,:,2].max())
     ds_once_img = ds_once_img.astype(np.uint8)
     imageio.imwrite("downscaled_once.png", ds_once_img)

     ds_many_img = f_downscaled_many[0].permute(1, 2, 0).cpu().numpy()
     ds_many_img[:,:,0] -= ds_many_img[:,:,0].min()
     ds_many_img[:,:,0] *= (255.0/ds_many_img[:,:,0].max())
     ds_many_img[:,:,1] -= ds_many_img[:,:,1].min()
     ds_many_img[:,:,1] *= (255.0/ds_many_img[:,:,1].max())
     ds_many_img[:,:,2] -= ds_many_img[:,:,2].min()
     ds_many_img[:,:,2] *= (255.0/ds_many_img[:,:,2].max())
     ds_many_img = ds_many_img.astype(np.uint8)
     imageio.imwrite("downscaled_many.png", ds_many_img)

ds_once_stats = np.array(ds_once_stats)
ds_many_stats = np.array(ds_many_stats)  


ds_once_data = np.concatenate(ds_once_data, axis=0)
ds_many_data = np.concatenate(ds_many_data, axis=0)
all_data = np.concatenate([ds_once_data, ds_many_data], axis=0)

from sklearn.decomposition import PCA
pca = PCA(n_components=2, svd_solver='full')
pca.fit(all_data)
all_data_transformed = pca.transform(all_data)

plt.scatter(all_data_transformed[:ds_once_data.shape[0],0], all_data_transformed[:ds_once_data.shape[0],1], 
color='red', label='downscaled once', marker='x',alpha=0.5)

plt.scatter(all_data_transformed[ds_once_data.shape[0]:,0], all_data_transformed[ds_once_data.shape[0]:,1], 
color='blue', label='downscaled many times', marker='o',alpha=0.5)
plt.legend()
plt.xlabel("PCA dimension 1")
plt.ylabel("PCA dimension 2")
plt.title("PCA decomposition of 2D "+str(ds)+"x downscaled fluid frames slices")
plt.show()

plt.clf()

plt.plot()
plt.plot(np.arange(0, ds_once_stats.shape[0]), ds_once_stats[:,0], marker='x', label='downscaled once minimum velocity component')
plt.plot(np.arange(0, ds_many_stats.shape[0]), ds_many_stats[:,0], marker='o', label='downscaled many minimum velocity component')
plt.plot(np.arange(0, ds_once_stats.shape[0]), ds_once_stats[:,1], marker='x', label='downscaled once maximum velocity component')
plt.plot(np.arange(0, ds_many_stats.shape[0]), ds_many_stats[:,1], marker='o', label='downscaled many maximum velocity component')
plt.plot(np.arange(0, ds_once_stats.shape[0]), ds_once_stats[:,2], marker='x', label='downscaled once mean velocity component')
plt.plot(np.arange(0, ds_many_stats.shape[0]), ds_many_stats[:,2], marker='o', label='downscaled many mean velocity component')
plt.plot(np.arange(0, ds_once_stats.shape[0]), ds_once_stats[:,3], marker='x', label='downscaled once std of velocity component')
plt.plot(np.arange(0, ds_many_stats.shape[0]), ds_many_stats[:,3], marker='o', label='downscaled many std of velocity component')
plt.legend()
plt.xlabel("Simulation timestep")
plt.ylabel("m/s")
plt.title("Min/max/mean/std of data downscaled by a factor of " + str(ds) + "x once or a factor of 2x " + str(int(np.log(ds)/np.log(2))) + " times")
plt.show()
'''

'''
# This experiment shows the seams between leaf nodes of a quadtree
# when they are upscaled separately

skip = 32
ds = 8
a = imageio.imread("./TestingData/quadtree_images/Lenna.jpg").astype(np.float32)
b = torch.tensor(a).cuda().permute(2, 0, 1).unsqueeze(0)
c = F.interpolate(b.clone()[:,:,::ds,::ds], mode="bilinear", scale_factor=ds, align_corners=True)
c = c[0].permute(1, 2, 0).cpu().numpy()
imageio.imwrite("Lenna_noseams.jpg", c)

a[::skip, :, :] = np.array([0, 0, 0])
a[:, ::skip, :] = np.array([0, 0, 0])


imageio.imwrite("Lenna_cutput.jpg", a)

for x in range(0, b.shape[2], skip):
     for y in range(0, b.shape[3], skip):
          b[:,:,x:x+skip,y:y+skip] = F.interpolate(b[:,:,x:x+skip:ds,y:y+skip:ds], 
          scale_factor=ds, mode="bilinear", align_corners=True)
b = b[0].permute(1, 2, 0).cpu().numpy()
imageio.imwrite("Lenna_seams.jpg", b)

'''








'''
# This experiment tests which downscaling methods follow have the property
# downscale(x, S) = downscale(downscale(x, S/2), S/2)


a = torch.randn([1, 1, 16, 16]).cuda()
b = a.clone()

a = F.interpolate(a, scale_factor=0.5, mode='bilinear', align_corners=True)
a = F.interpolate(a, scale_factor=0.5, mode='bilinear', align_corners=True)
b = F.interpolate(b, scale_factor=0.25, mode='bilinear', align_corners=True)

print("Bilinear interpolation difference: " +str((b-a).sum()))

a = torch.randn([1, 1, 16, 16]).cuda()
b = a.clone()

a = F.interpolate(a, scale_factor=0.5, mode='bicubic', align_corners=True)
a = F.interpolate(a, scale_factor=0.5, mode='bicubic', align_corners=True)
b = F.interpolate(b, scale_factor=0.25, mode='bicubic', align_corners=True)

print("Bicubic interpolation difference: " +str((b-a).sum()))

a = torch.randn([1, 1, 16, 16]).cuda()
b = a.clone()

a = AvgPool2D(a, 2)
a = AvgPool2D(a, 2)
b = AvgPool2D(b, 4)

print("Avgerage pooling difference: " +str((b-a).sum()))

a = torch.randn([1, 1, 16, 16]).cuda()
b = a.clone()

a = a[:,:,::2,::2]
a = a[:,:,::2,::2]
b = b[:,:,::4,::4]

print("Subsampling difference: " +str((b-a).sum()))
'''

'''
f = h5py.File('bigboy.h5', 'r')
data = torch.tensor(f['data']).type(torch.FloatTensor).cuda()
f.close()
data = data.unsqueeze(0)
data_mag = torch.linalg.norm(data,axis=1)[0]

data_mag /= data_mag.max()
image_out = torch.zeros(data_mag.shape).cuda()
image_out = image_out.unsqueeze(2)
image_out = image_out.repeat(1, 1, 3)
'''
#plt.hist(data_mag.cpu().numpy().flatten(), bins=25, density=True, cumulative=True)
#plt.show()

'''
# black white red
color_mapping_keys = [0.01, 0.3, 0.6]
color_mapping_values = [torch.from_numpy(np.array([0.0, 0.0, 0.0])).type(torch.FloatTensor).cuda(), 
                        torch.from_numpy(np.array([200.0, 200.0, 200.0])).type(torch.FloatTensor).cuda(),
                        torch.from_numpy(np.array([200.0, 0.0, 0.0])).type(torch.FloatTensor).cuda()]
'''
'''
# rainbow               R   O    Y     G    B    I     V     R
color_mapping_keys = [0.0, 0.08, 0.16, 0.25, 0.3, 0.35, 0.4, 1.0]
color_mapping_values = [torch.from_numpy(np.array([128, 0.0, 0.0])).type(torch.FloatTensor).cuda(), 
                        torch.from_numpy(np.array([255.0, 136.0, 0.0])).type(torch.FloatTensor).cuda(),
                        torch.from_numpy(np.array([255.0, 255.0, 0.0])).type(torch.FloatTensor).cuda(),
                        torch.from_numpy(np.array([0.0, 255.0, 0.0])).type(torch.FloatTensor).cuda(),
                        torch.from_numpy(np.array([0.0, 0.0, 255.0])).type(torch.FloatTensor).cuda(),
                        torch.from_numpy(np.array([0.0, 255.0, 200.0])).type(torch.FloatTensor).cuda(),
                        torch.from_numpy(np.array([128.0, 76.0, 128.0])).type(torch.FloatTensor).cuda(),
                        torch.from_numpy(np.array([128.0, 0.0, 0.0])).type(torch.FloatTensor).cuda()]
'''

'''
# another             blk       Y     G    B    I     V     R
color_mapping_keys = [0.0, 0.21, 0.41, 0.6]
color_mapping_values = [torch.from_numpy(np.array([9.0, 171.0, 166.0])).type(torch.FloatTensor).cuda(), 
                        torch.from_numpy(np.array([0.0, 0.0, 0.0])).type(torch.FloatTensor).cuda(),
                        torch.from_numpy(np.array([121.0, 9.0, 9.0])).type(torch.FloatTensor).cuda(),
                        torch.from_numpy(np.array([255.0, 255.0, 255.0])).type(torch.FloatTensor).cuda(),
                        ]
image_out[data_mag < color_mapping_keys[0]] = color_mapping_values[0]

for i in range(len(color_mapping_keys)-1):
    ratios = data_mag.clone()
    ratios -= color_mapping_keys[i]
    ratios *= 1 / (color_mapping_keys[i+1] - color_mapping_keys[i])
    ratios = ratios.type(torch.FloatTensor).cuda()
    
    cmap = (1-ratios).view(ratios.shape[0], ratios.shape[0], 1).repeat(1, 1, 3) \
         * color_mapping_values[i].view(1, 1, 3).repeat(ratios.shape[0], ratios.shape[1], 1) 
    cmap += color_mapping_values[i+1].view(1, 1, 3).repeat(ratios.shape[0], ratios.shape[1], 1) \
         * ratios.view(ratios.shape[0], ratios.shape[0], 1).repeat(1, 1, 3)
    
    indices = torch.bitwise_and(data_mag >= color_mapping_keys[i],
    data_mag < color_mapping_keys[i+1])
    image_out[indices] = cmap[indices]

image_out[data_mag > color_mapping_keys[-1]] = color_mapping_values[-1]

img = image_out.cpu().numpy().astype(np.uint8)
imageio.imwrite("bigboy.jpg", img)
'''